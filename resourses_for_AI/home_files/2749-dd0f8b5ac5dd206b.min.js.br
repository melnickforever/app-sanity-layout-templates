"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="18bfa023-56ed-51a3-9120-d05c3cfed9fb")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([["2749"],{813377(e,t,i){i.d(t,{Jw:()=>o,Lm:()=>n,NQ:()=>m,Y1:()=>c,h3:()=>a,i1:()=>r,li:()=>d,um:()=>s,vL:()=>l,xW:()=>p,zP:()=>u});let a="desktop_tool_bar--toolBarSpacerContainer--QHjvw",n="desktop_tool_bar--toolBarContainer--YXqld",o="desktop_tool_bar--pageViewToolBarContainer---GRvv desktop_tool_bar--toolBarContainer--YXqld",r="desktop_tool_bar--toolBarLeftSide--VLxNs text--fontPos13--5OfL8 text--_fontBase--VaHfk",l="desktop_tool_bar--toolBarCenter--pselG",s="desktop_tool_bar--toolBarCenterFullWidth--O7MqO",d="desktop_tool_bar--toolBarRightSide--sboAs",c="desktop_tool_bar--toolBarTabContent--hlC3M ellipsis--ellipsis--70pHK",u="desktop_tool_bar--toolBarTabContentBase--k6SY4",m="desktop_tool_bar--adminSettingsToolBarTabContentBase--SOWuW",p="desktop_tool_bar--adminSettingsToolBarTabContentSelected--tHikX"},700141(e,t,i){if(i.d(t,{T:()=>g,b:()=>b}),1464==i.j)var a=i(741542);var n=i(350923),o=i(779757),r=i(63633),l=i(870527),s=i(838719),d=i(668522),c=i(153480),u=i(425145),m=i(473397),p=i(271332),_=i(487817),h=i(644350),f=i(331850);let b=(0,n.Iz)(e=>(0,n.eU)(t=>e?t((0,c.K)((0,h.WF4)({orgId:e}))).transform(({org:e})=>!!(0,d.oA)(e?.isSalesAssistedPlanProperty)?.value&&!(0,d.oA)(e?.subscriptionShouldNotAutoRenewPlanProperty)&&(0,d.oA)(e?.plan?.termsOfServiceAcceptanceByTermsKey)?.termsKey!==_.Lb.SEATS_MODEL_BILLING_2025):o.Qw.disabled()));function g(e,t){let i=(0,m.CT)(),o=(0,r.Xf)(e?.id),c=(0,p.n)(),_=(0,n.md)(b(e?.id??null)),h=(0,f.D6)("useProductTermsEligibility"),g=(0,f.j_)(h).unwrapOr(!1),y=o.data?.analyze_data_contract_v2_start,v=y?(0,l.A)(y):null,w=(0,u.w)(),x=!!v&&w.isBefore(v)&&90>=v.diff(w,"day"),k=!!v&&w.isBefore(v)&&30>=v.diff(w,"day"),C=(0,l.A)((0,s.initialOptions)().analyze_data_flow_v2_until),j=!!e&&(0,l.A)(e.created_at).isBefore(C),A=(0,a.getFeatureFlags)().terms_of_service_may_2025_update;return e?.id&&(g||t)&&j&&i&&("loaded"!==_.status||_.data)?"loading"===o.status||"loading"===_.status?(0,d.Xm)():x&&_.data&&(c||A&&k)?(0,d.gB)({isEligible:!0,orgTermsInfo:{organizationName:e?.name??"organization",renewalDate:v}}):(0,d.gB)({isEligible:!1}):(0,d.gB)({isEligible:!1})}},537916(e,t,i){i.d(t,{y:()=>l});var a=i(857336),n=i(714405),o=i(798413);function r(e,t,i){return e?.plansByUserId[t]?.find(e=>e.plan_id===i)}function l(e,t,i,l,s){let{userId:d,orgId:c,teamId:u}=e,m=i.authedUsers.byId[d],p=l?l.orgs.reduce((e,t)=>({...e,[t.id]:t}),{}):i.orgById,_=l?l.teams.reduce((e,t)=>({...e,[t.id]:t}),{}):i.teams,h=(0,n.HE)(i,e,p,_),f=(0,o.R$)(m,c),b=!!s&&!(0,a.MJ)(c?p[c]:null,u?_[u]:null,null);if(!c){let t=r(l,d,u),i=t?.is_plan_locked,a=t?.draft_folder_id;return{...e,user:m,workspaceName:h,isDisabledDueToECC:f,isDsePresetsDisabled:b,isPlanLocked:i,draftFolderId:a}}let g=i.orgById[c];if(g?.standing==="SUSPENDED")return null;let y=!!g?.figjam_disabled_at&&"whiteboard"===t,v=!!g?.is_slides_disabled&&"slides"===t,w=r(l,d,c),x=(w?.is_sites_disabled??!0)&&"sites"===t,k=(w?.is_cooper_disabled??!0)&&"cooper"===t,C=(w?.is_figmake_disabled??!0)&&"figmake"===t,j=w?.is_community_resources_disabled??!1,A=w?.is_plan_locked,I=w?.draft_folder_id;return{...e,user:m,workspaceName:h,isFigJamDisabled:y,isDisabledDueToECC:f,isDsePresetsDisabled:b,isSlidesDisabled:v,isSitesDisabled:x,isCooperDisabled:k,isFigmakeDisabled:C,isCommunityResourcesDisabled:j,isPlanLocked:A,draftFolderId:I}}},695621(e,t,i){i.d(t,{NX:()=>X,dr:()=>Y,y_:()=>z});var a=i(239976),n=i(105652),o=i(645186),r=i(497935),l=i(850159),s=i(741542),d=i(335127),c=i(480507),u=i(37760),m=i(181645),p=i(463592),_=i(140979),h=i(668522),f=i(462198),b=i(780165),g=i(42053),y=i(116682),v=i(613629),w=i(787486),x=i(575425),k=i(578880),C=i(506026);let j=2e3,A="long-running-operation-loading";var I=i(352393),T=i(508295),N=i(644350),S=i(860857),R=i(520435),P=i(817482),M=i(290133),E=i(271044);class F{constructor(e,t,i){this.args=e,this.subscription=t,this.user=i,this.livegraphClient=null}}class D{constructor(e){this.client=e}getReactionsForPost(e){if("loaded"!==this.client.subscription.status)throw Error("Unable to get reaction for unloaded subscription");let t=this.client.subscription.data.file;if(!t)throw Error("Unable to get reaction for unloaded subscription");let i=t.feedPosts.find(t=>t.publicUuid===e);if(!i)throw Error("Unable to find post");let a={};for(let e of i.comments)a[e.id]=e.reactions;return{postReactions:i.reactions,commentReactions:a}}}var B=i(39193),O=i(733921),U=i(185733),L=i(865876),$=i(385624),V=i(830772);class q{constructor(e){this.client=e}toggleReaction(e,t,i){if("loaded"!==this.client.subscription.status)throw Error("Unable to toggle reactions for unloaded subscription");return this.getReactions(e).find(i=>i.emoji===t&&i.fileCommentId===e&&i.userId===this.client.user.id)?this.removeReaction(e,t):this.addReaction(e,t,i)}async addReaction(e,t,i){let a=y.Ay.post(`/api/file/${this.client.fileKey}/comments/${e}/reactions`,{emoji:t,prototype_mode:i?.prototype_mode||!1,selected_view:i?.selectedView||"",quick_reply:i?.quickReply||!1});return this.client.optimistically(async(i,n,o)=>{let r=new Date,l=`${e}_${t}_${o.id}`;await n.optimisticallyCreate({CommentReaction:{[l]:{fileCommentId:e,emoji:t,fileKey:i.file.id,userId:o.id,user:{id:o.id,handle:o.handle,imgUrl:o.img_url},createdAt:r,sortTimestamp:r}}},a)}),await a}async removeReaction(e,t){let i=y.Ay.del(`/api/file/${this.client.fileKey}/comments/${e}/reactions`,{emoji:t});return this.client.optimistically(async(a,n,o)=>{let r=o.id,l=this.getReactions(e).filter(e=>e.emoji===t&&e.userId===r).map(e=>e.id),s=l?.reduce((e,t)=>({...e,[t]:null}),Object.create(null));await n.optimisticallyDelete({CommentReaction:s},i)}),await i}getReactions(e){if("loaded"!==this.client.subscription.status)throw Error("Unable to get reaction for unloaded subscription");let t=this.client.subscription.data.file;if(!t)throw Error("Unable to get reaction for unloaded subscription");if("reactions"in t)return t.reactions.filter(t=>t.fileCommentId===e);{let i=t.mobileCommentThread.find(t=>t.id===e);return i?i.reactions:[]}}}function H(e){return e.map(e=>({...e,id:e.id.toString()}))}let G=(0,c.xx)(e=>{let t=e=>(e.hasOwnProperty("transform")||Object.defineProperty(e,"transform",{get:()=>({filter:i=>t(e.filter(i)),map:i=>t(e.map(i)),join:i=>t([...e,...i||[]])})}),e);return t(e)});function z(e){let t=n.useMemo(()=>(0,u.g)(),[e]),i=(0,_.bc)(M.$J,e,{enabled:!!e.fileKey,traceId:t}),a=(0,_.bc)(N.ZBn,e,{enabled:!!e.fileKey});return{combinedResult:n.useMemo(()=>{if("loaded"!==i.status||!i.data.file)return i;let e=G(i.data.file.comments).transform.filter(e=>null===e.resolvedAt);if("loaded"===a.status){let t=a.data.file?.resolvedComments;e=e.transform.join(t)}let t={...i.data.file,comments:e};return{...i,data:{...i.data,file:t}}},[i,a]),resolvedSubscription:a,unresolvedSubscription:i}}class K{constructor(e){this.client=e}trackMissingCommentData(e,t,i,a,n,o){let r=!1,l=(t,l)=>{if(!r&&(r=!0,(0,f.kF)("comments_optimistic_updates","true"),(0,f.kF)("isLoadedComments",n.isLoadedComments?"true":"false"),(0,f.kF)("commentType",e),(0,g.x1)(t,l,{id:i.id,fileKey:this.client.fileKey,parentId:i.parent_id,pageId:i.client_meta?.page_id,userId:this.client.user.id,clientMeta:i.client_meta,...o}),this.client.livegraphClient)){for(let e of a())"SESSION.APPLY_MUTATIONS"===e.type||"SESSION.APPLY_SHADOW_MUTATIONS"===e.type||"REQUEST_MESSAGE"===e.type&&"sync"===e.message.messageType||"RESPONSE_MESSAGE"===e.type&&"synced"===e.message.messageType||"RESPONSE_MESSAGE"===e.type&&"pendingMutations"===e.message.messageType?(0,g.Lo)(t,JSON.stringify(e)):"SESSION.NOTIFY_OBSERVERS"===e.type&&e.view._name.includes("Comments")&&(0,g.Lo)(t,JSON.stringify({type:"SESSION.NOTIFY_OBSERVERS",viewName:e.view._name}));(0,g.x1)(t,l)}};U.O.records[i.id]={parentId:i.parent_id,report:l},setTimeout(()=>{let n=U.O.records[i.id];if(n||a(),delete U.O.records[i.id],"loaded"!==this.client.subscription.status)return;let o=this.client.loadedComments.some(e=>e.id===i.id||e.id===t);n&&!o?n.report(`${e} Never Appeared`,"Comment failed to appear within ten seconds of creation"):a()},1e4)}create(e,t){let i=(0,p.S6)(),{fileKey:a,messageMeta:n,attachments:o,clientMeta:r,pageId:l,uuid:s,makeContext:d}=e;(0,m.sx)("New comment API create",{uuid:s});let c=[],u=async e=>{let i=e.data?.reason;if(!i||"comment_validation_failure"!==i.reason||!t?.onValidationError)throw e;let p=i.failure_info,_=await t.onValidationError(H(p.users_without_view),H(p.ext_users_without_view),H(p.uninvitable_users),p.user_groups_without_access,p.commenting_user_cannot_invite);return _?((0,m.sx)("New comment API handling validation",{uuid:s}),y.Ay.post(`/api/file/${a}/comments`,{file_key:a,message_meta:n,attachments:o.map(e=>e.id),client_meta:r,page_id:l,prototype_mode:t?.prototypeMode,share_to_mentions:_.forceWithInvite,uuid:s,pending_mentions:c,...d&&{make_context:{chat_message_id:d.chatMessageId,source_code_hash:d.sourceCodeHash,file_sequence_number:d.fileSequenceNumber,message_index:d.messageIndex,version_name:d.versionName,route_url:d.routeURL,version_id:d.versionId}}}).catch(u)):null},_=(0,B.e)(this.client.subscription),h=this.client.subscription.data?.file?.currentUserCommentReadStatus,f=y.Ay.post(`/api/file/${a}/comments`,{file_key:a,message_meta:n,attachments:o.map(e=>e.id),client_meta:r,page_id:l,prototype_mode:t?.prototypeMode,share_to_mentions:null===t.onValidationError,pending_mentions:c,uuid:s,...!h&&{all_read_at:L.gj.allReadAt},...d&&{make_context:{chat_message_id:d.chatMessageId,source_code_hash:d.sourceCodeHash,file_sequence_number:d.fileSequenceNumber,message_index:d.messageIndex,version_name:d.versionName,route_url:d.routeURL,version_id:d.versionId}}});return this.client.optimistically((e,t)=>{let i=this.client.loadedComments.map(e=>e.orderId||0),l=i.length>0?Math.max(...i):0,d=(0,V.Rc)(n);t.optimisticallyCreateWithUUID({Comment:{[s]:{uuid:s,key:a,userId:this.client.user.id,parentId:null,orderId:l+1,canRead:!0,createdAt:new Date,resolvedAt:null,deletedAt:null,clientMeta:{x:r.x,y:r.y,nodeId:r.node_id||null,pageId:r.page_id||null,nodeOffset:r.node_offset||null,inFrame:r.in_frame||null,selectionBoxAnchor:r.selection_box_anchor||null,stablePath:r.stable_path||null},messageMeta:d,messageMetaStylized:d,user:{id:this.client.user.id,handle:this.client.user.handle,imgUrl:this.client.user.img_url},reactions:[],thumbnailUrl:null,isCanvasMention:!1,commentPin:null}}},f);let c=(0,P.Mu)(o,a,s);if(c&&t.optimisticallyCreate({CommentAttachment:c},f),!e.file.currentUserCommentReadStatus){let e=new Date;t.optimisticallyCreate({CommentReadStatus:{[`pending-comment-read-status-${e.getTime()}`]:{userId:this.client.user.id,fileKey:this.client.fileKey,createdAt:e,allReadAt:L.gj.allReadAt,readComments:{},unreadComments:{}}}},f)}}),[f.catch(u).then(e=>{if(!e)return null;try{let a=e.data.meta;this.trackMissingCommentData("New Comment",s,a,i,{isLoadedComments:_},t)}catch{}return e}),s]}reply(e,t){let i=(0,p.S6)(),{threadId:a,threadUuid:n,messageMeta:o,attachments:r,uuid:l,makeContext:s}=e,{fileKey:d}=this.client,c=(0,V.cs)(o),u=y.Ay.post(`/api/file/${d}/comments/${e.threadId}`,{file_key:d,uuid:l,message_meta:o,attachments:r.map(e=>e.id),prototype_mode:t?.prototypeMode,share_to_mentions:t.forceWithInvite||!1,tracking_context:t.trackingContext,pending_mentions:c,...s&&{make_context:{chat_message_id:s.chatMessageId,source_code_hash:s.sourceCodeHash,file_sequence_number:s.fileSequenceNumber,message_index:s.messageIndex,version_name:s.versionName,version_id:s.versionId}}}),_=(0,V.Rc)(o),h=(0,B.e)(this.client.subscription),{user:f}=this.client;return this.client.optimistically((e,t)=>{n?t.optimisticallyUpdateWithUUID({Comment:{[n]:{uuid:n,resolvedAt:null}}},u):t.optimisticallyUpdate({Comment:{[a]:{resolvedAt:null}}},u),(0,m.sx)("Livegraph Optimistic Comment Update",{flow:"reply",isOptimistic:!!n}),t.optimisticallyCreateWithUUID({Comment:{[l]:{uuid:l,key:d,userId:f.id,parentId:a,orderId:null,canRead:!0,createdAt:new Date,resolvedAt:null,deletedAt:null,clientMeta:null,messageMeta:_,messageMetaStylized:_,user:{id:f.id,handle:f.handle,imgUrl:f.img_url},reactions:[],thumbnailUrl:null,isCanvasMention:!1,commentPin:null,attachments:r.map(e=>(0,P.QG)(e,d,l))}}},u);let i=(0,P.Mu)(r,d,l);i&&t.optimisticallyCreate({CommentAttachment:i},u)}),[u.then(e=>{if(!e)return null;let a=e.data.meta;return this.trackMissingCommentData("Reply Comment",l,a,i,{isLoadedComments:h},t),e}),l]}}class W{constructor(e){this.client=e}get commentReceipts(){return this}async markAsUnread(e){let t=this.client.subscription.data?.file?.currentUserCommentReadStatus,i=y.Ay.post(`/api/file/${this.client.fileKey}/unread_comments`,{comment_ids:[e],...!t&&{all_read_at:L.gj.allReadAt}});return this.client.optimistically(async(t,a,n)=>{let o=t.file.currentUserCommentReadStatus,r=new Date;if(o){let{[e]:t,...n}=o.readComments;await a.optimisticallyUpdate({CommentReadStatus:{[o.id]:{...o,allReadAt:L.gj.allReadAt,readComments:n,unreadComments:{...o.unreadComments,[e]:"true"}}}},i)}else await a.optimisticallyCreate({CommentReadStatus:{[`pending-comment-read-status-${r.getTime()}`]:{userId:n.id,fileKey:this.client.fileKey,createdAt:r,allReadAt:L.gj.allReadAt,readComments:{},unreadComments:{[e]:"true"}}}},i)}),await i}async markAllAsRead(){let e=this.client.subscription.data?.file?.currentUserCommentReadStatus,t=y.Ay.del(`/api/file/${this.client.fileKey}/unread_comments`,{...!e&&{all_read_at:L.gj.allReadAt}});return this.client.optimistically(async(e,i,a)=>{let n=e.file.currentUserCommentReadStatus,o=new Date;n?await i.optimisticallyUpdate({CommentReadStatus:{[n.id]:{...n,allReadAt:o,readComments:{},unreadComments:{}}}},t):await i.optimisticallyCreate({CommentReadStatus:{[`pending-comment-read-status-${o.getTime()}`]:{userId:a.id,fileKey:this.client.fileKey,createdAt:o,allReadAt:o,readComments:{},unreadComments:{}}}},t)}),await t}async markAsRead(e){let t=this.client.subscription.data?.file?.currentUserCommentReadStatus,i=y.Ay.del(`/api/file/${this.client.fileKey}/unread_comments`,{comment_ids:e,...!t&&{all_read_at:L.gj.allReadAt}});return this.client.optimistically(async(t,a,n)=>{let o=t.file.currentUserCommentReadStatus,r=new Date,l=e.reduce((e,t)=>({...e,[t]:r.toUTCString()}),{});o?await a.optimisticallyUpdate({CommentReadStatus:{[o.id]:{...o,readComments:{...o.readComments,...l},unreadComments:Object.keys(o.unreadComments).filter(t=>!e.includes(t)).reduce((e,t)=>(e[t]="true",e),{})}}},i):await a.optimisticallyCreate({CommentReadStatus:{[`pending-comment-read-status-${r.getTime()}`]:{userId:n.id,fileKey:this.client.fileKey,createdAt:r,allReadAt:L.gj.allReadAt,readComments:l,unreadComments:{}}}},i)}),await i}}function Q(e,t,i){let a=n.useMemo(()=>{if("loaded"!==i.status)return new Set([]);let e=i.data.file;return new Set(e?"comments"in e?e.comments.map(e=>e.id):e.resolvedComments.map(e=>e.id):[])},[i]),o=(0,d.ZC)(a),{removed:r}=n.useMemo(()=>(0,b.Zv)(a,o),[a,o]),l=n.useCallback(e,t);n.useEffect(()=>{r.forEach(e=>{l(e)})},[l,r])}function Y(e){let t=(0,_.ZA)(),i=(0,T.iZ)(),{args:a,subscription:o}=e,[l,s]=n.useState(()=>{if(i)return new B.I(a,o,i)});return n.useEffect(()=>{i?l&&(0,r.c2)(l.args,a)||s(new B.I(a,o,i)):s(void 0)},[l,a,o,i,t]),l&&(i&&(l.user=i),l.subscription=o,l.livegraphClient=t),n.useMemo(()=>l?{commentReceipts:new W(l),reactionsApi:new q(l),writeAPI:new K(l),pinApi:new O.xI(l)}:{},[l])}function X(e){let{userId:t,file:i,activeId:c,anchorPositions:u,boundingBoxPositions:m,DEPRECATED_updateWatchedNodeIds:p,updateWatchedStablePaths:f,getPageIdsForNodes:b,enableCommentsLoadingVisualBell:g=!1,children:y}=e,P=n.useRef({}),B=(0,k.E3)()===x.nT.Whiteboard,O=!!(0,s.getFeatureFlags)().xr_debounce_threshold,L=i?.key,V=!!L,q=n.useMemo(()=>({fileKey:L??""}),[L]),H=(0,_.bc)(N.qRE,q,{enabled:O&&V}),G=(0,_.bc)(N.gkf,q,{enabled:B&&V}),K=(0,o.d4)(e=>e.comments.lgPendingUuidToServerIdMap),W=(0,o.wA)(),{combinedResult:X,resolvedSubscription:J,unresolvedSubscription:Z}=z(q);(({longRunningLoadingMessage:e,longRunningSuccessMessage:t,longRunningThresholdMs:i=j,result:a,enabled:r})=>{let l=(0,o.wA)(),s=n.useRef(!1),c=n.useRef(null),u=n.useCallback(()=>{c.current&&clearTimeout(c.current),l(v.F.dequeue({matchType:A}))},[l]);n.useEffect(()=>(r&&"loading"===a.status&&(c.current=setTimeout(()=>{s.current=!0,l(v.F.enqueue({message:e,type:A,timeoutOverride:1/0,icon:C.zX.SPINNER,preventDismissal:!0}))},i)),u),[l,e,i,u,r,a.status]);let m=(0,d.ZC)(a.status);n.useEffect(()=>{r&&"loaded"===a.status&&"loaded"!==m&&s.current&&t&&l(v.F.enqueue({message:t,type:"long-running-operation-success"}))},[a.status,m,t,l,r])})({result:Z,longRunningLoadingMessage:(0,l.t)("comments.loading"),enabled:!!(0,s.getFeatureFlags)().comments_load_visual_bell&&g}),Q(e=>{U.O.records[e]?.report?.("New Comment Missing","Comment disappeared within ten seconds of creation")},[],Z),Q(e=>{U.O.records[e]?.report?.("New Resolved Comment Missing","Resolved comment disappeared within ten seconds of creation")},[],J),n.useEffect(()=>{(0,s.getFeatureFlags)().comments_load_visual_bell&&"errors"===X.status&&W(v.F.enqueue({message:(0,l.t)("comments.failed_to_load_comments"),error:!0}))},[W,X.status]),n.useMemo(()=>{"loaded"===X.status&&X.data?.file?.comments?.forEach(e=>{e.id in K?(P.current[e.id]=e,e.id=K[e.id]):e.uuid&&e.uuid in K&&P.current[e.uuid]&&P.current[e.uuid]!==e&&(W((0,R.pI)({commentUuid:e.uuid})),delete P.current[e.uuid])})},[W,X,K]);let ee=(0,o.d4)(e=>e.mirror.appModel.pagesList),{commentsAttachedToNodes:et,commentThreadNodeIds:ei,commentThreadStablePaths:ea}=n.useMemo(()=>{if("loaded"!==X.status||!X.data.file)return{commentThreadsNodeIds:[],commentsAttachedToNodes:[]};let e=[],t=new Set,i=new Set;return X.data.file.comments.forEach(a=>{if(null===a.parentId){let n=a.clientMeta?.nodeId,o=a.clientMeta?.stablePath;o&&f?(e.push(a),i.add(`[${o.join(",")}]`)):n&&p&&(e.push(a),t.add(n))}}),{commentsAttachedToNodes:e,commentThreadNodeIds:t,commentThreadStablePaths:i}},[X,p,f]),en=n.useMemo(()=>{if("loaded"!==X.status||!X.data.file||O&&!H.data?.file)return[];let e=new Set(ei);return O&&(0,I.N)(H.data.file.feedPosts).forEach(t=>{e.add(t)}),Array.from(e)},[X,H,O,ei]),eo=n.useMemo(()=>"loaded"===X.status&&X.data.file?Array.from(new Set(ea)):[],[X,ea]);n.useEffect(()=>{p&&p(en),f&&f(eo)},[p,en,f,eo]);let er=(0,$.W9)(t,X,c,u,b,ee),el=(0,$.gu)(t,G,e.activeId),es=(0,S.in)(H,e.activeId,b,m),ed=n.useMemo(()=>{if("loaded"!==X.status||O&&"loaded"!==H.status||B&&"loaded"!==G.status)return(0,h.gB)([]);let e=[];return er.data&&(e=e.concat(er.data)),el.data&&(e=e.concat(el.data)),es.data&&(e=e.concat(es.data)),(0,h.gB)(e)},[X.status,O,H.status,B,G.status,er.data,el.data,es.data]),ec=Y({args:q,subscription:X}),eu=function(e){let t=(0,_.ZA)(),i=(0,T.iZ)(),{args:a,subscription:o}=e,[l,s]=n.useState(()=>{if(i)return new F(a,o,i)});return n.useEffect(()=>{(0,E.y)()&&i?l&&(0,r.c2)(l.args,a)||s(new F(a,o,i)):s(void 0)},[l,a,o,i,t]),l&&(i&&(l.user=i),l.subscription=o,l.livegraphClient=t),n.useMemo(()=>l?{reactionsApi:new D(l)}:{},[l])}({args:q,subscription:H});ec.canvasMentionReceipts=(0,w.pf)({canvasMentionArgs:q,canvasMentionSubscription:G}),(0,$.Hu)(et,{enabled:!!(0,s.getFeatureFlags)().comments_absolute_positioning});let em=n.useMemo(()=>V?{...X,api:ec,feedApi:eu,threads:ed,isUnresolvedLoaded:"loaded"===X.status}:{status:"loading",data:null,errors:null,threads:(0,h.Xm)(),api:{},isUnresolvedLoaded:!1},[V,X,ec,eu,ed]);return(0,a.jsx)(M.kR,{value:em,children:y})}},74970(e,t,i){i.d(t,{d:()=>W});var a=i(239976),n=i(105652),o=i(645186),r=i(270668),l=i(916290),s=i(606335),d=i(799680),c=i(15369),u=i(50594),m=i(850159),p=i(37760),_=i(181645),h=i(275012),f=i(140979),b=i(834116),g=i(90550),y=i(86057),v=i(197684),w=i(660983),x=i(38900),k=i(520435),C=i(290133),j=i(435626),A=i(947234),I=i(455903),T=i(211468),N=i(695621),S=i(865876),R=i(273291),P=i(803126),M=i(508295),E=i(385990),F=i(644350),D=i(840712),B=i(331850),O=i(72655),U=i(944598),L=i(158078),$=i(539503),V=i(519763);let q="thread_view--column--lzuCC",H="thread_view--fileName--R5q0r",G="thread_view--headerButton--olwf9",z=new class{get file(){throw Error("Data should not be accessed directly from quick replies, we need to create standard API for comments to use this view. see: file_comments_api.tsx")}get fileFollower(){throw Error("Data should not be accessed directly from quick replies, we need to create standard API for comments to use this view. see: file_comments_api.tsx")}get comments(){throw Error("Data should not be accessed directly from quick replies, we need to create standard API for comments to use this view. see: file_comments_api.tsx")}},K=null,W=(0,n.forwardRef)((e,t)=>{let i=(0,f.bc)(F.Uhm,{fileKey:e.quickReplyInfo.fileKey,rootId:e.quickReplyInfo.threadId});return(0,a.jsx)("div",{className:"thread_view--container--cTKy7",ref:t,children:(0,a.jsxs)("div",{className:q,children:[(0,a.jsxs)("div",{className:"thread_view--header--09jNq",children:[(0,a.jsx)("div",{className:G,children:!e.fileBrowser&&(0,a.jsx)(v.J,{"aria-label":(0,m.t)("quick_reply.navigate_back"),onClick:e.onClose,children:(0,a.jsx)(s.C,{})})}),e.fileBrowser?(0,a.jsx)("div",{className:H,children:"loaded"===i.status&&i.data.file&&i.data.file.name}):(0,a.jsx)("h2",{className:H,children:"loaded"===i.status&&i.data.file&&i.data.file.name}),(0,a.jsx)("div",{className:G,children:e.fileBrowser?(0,a.jsx)(v.J,{"aria-label":(0,m.t)("quick_reply.close"),onClick:e.onClose,children:(0,a.jsx)(d.X,{})}):(0,a.jsx)("div",{style:{display:"none"},children:(0,a.jsx)(v.J,{"aria-label":(0,m.t)("quick_reply.more"),children:(0,a.jsx)(c.J,{})})})})]}),(0,a.jsx)(Q,{quickReplyInfo:e.quickReplyInfo,result:i,inFileBrowser:e.fileBrowser})]})})});function Q(e){let t=(0,M.iZ)();return t?"loading"===e.result.status||"disabled"===e.result.status?(0,a.jsx)(g.qc,{size:"medium"}):"errors"===e.result.status||null==e.result.data.file?(0,a.jsx)("div",{className:"thread_view--errorState--7WP7h",children:(0,m.t)("quick_reply.unable_to_load_thread")}):(0,a.jsx)(Y,{quickReplyInfo:e.quickReplyInfo,result:e.result,user:t,inFileBrowser:e.inFileBrowser}):null}function Y(e){let{quickReplyInfo:t,result:i,user:l}=e,{fileKey:s,threadId:d}=t,c=(0,N.dr)({args:{fileKey:s,rootId:d},subscription:i}),p=(0,o.wA)(),{file:f}=i.data,g=(0,O.Vc)(s).unwrapOr(null),y=(0,E.y)(g?.planRecordId)&&(0,B.zQ)(g),w=(0,n.useMemo)(()=>(0,D.mp)({currentOrgId:f.parentOrgId,teamId:f.teamId,fileKey:s,users:[],userGroupAtMentionsEnabled:y}),[f.parentOrgId,f.teamId,s,y]),{mobileCommentThread:x}=f,{currentUserCommentReadStatus:A}=f,I=x.find(e=>e.id===d),T=n.useMemo(()=>x.reduce((e,t)=>t.createdAt.getTime()>e.createdAt.getTime()?t:e).thumbnailUrl,[x]),R=(0,o.d4)(e=>e.comments.savingCommentUuids),P=(0,o.d4)(e=>e.comments.lgPendingUuidToServerIdMap);if(!I)return(0,a.jsx)("div",{children:(0,m.t)("quick_reply.unable_to_load_thread")});let M=x.map(e=>(0,S.G9)(l.id,I,e,A??S.gj,R,P,e.attachments)),F={id:I.id,key:s,anchored:!1,canvasPosition:null,selectionAnchorCanvasPosition:null,comments:M,messageMeta:M[0].message_meta,page:I.clientMeta?.pageId||null,isActive:!0,replyCount:x.length-1,isCanvasMention:!1,pageName:I.clientMeta?.pageId||null,sidebarItemType:j.kT.COMMENT_THREAD},U={api:c,status:i.status,data:z,threads:{status:i.status,data:[F],errors:i.errors},errors:i.errors,isUnresolvedLoaded:!0};return(0,a.jsx)(C.kR,{value:U,children:(0,a.jsxs)("div",{className:"thread_view--mouseContainer--SW4DP",onMouseEnter:()=>{let e=M.some(e=>e.isUnread);K=setTimeout(()=>{c.commentReceipts&&e&&(p(k.AY({receiptsAPI:c.commentReceipts,thread:F})),(0,_.sx)("Comment Thread Read",{commentThreadId:d,threadType:"file_browser_quick_reply"}))},1e3)},onMouseLeave:()=>{K&&clearTimeout(K)},children:[(0,a.jsxs)("div",{className:"thread_view--preview--N6rm9",children:[(0,a.jsx)(h.B,{children:(0,a.jsx)(b.oW,{src:T||void 0,className:"thread_view--previewImage--OqH10",style:{backgroundColor:(0,r.fileBackgroundColor)(f.checkpointClientMeta)},alt:"thumbnail"})}),(0,a.jsx)("div",{className:"thread_view--openFileButton--rVjXS",children:(0,a.jsx)(v.J,{"aria-label":(0,m.t)("quick_reply.open_file"),onClick:()=>{let e=t.deeplink??`/file/${s}?fuid=${l.id}&#${d}`;window.location.href=e},children:(0,a.jsx)(u.V,{})})})]}),(0,a.jsx)(X,{loadedComments:M,user:l,quickReplyInfo:t,commentMentionables:w,inFileBrowser:e.inFileBrowser})]})})}function X(e){let t,i,r,s,{loadedComments:d,user:c,quickReplyInfo:u,commentMentionables:_,inFileBrowser:h}=e,{fileKey:f,threadId:b}=u,g=(0,o.wA)();(0,n.useEffect)(()=>{g(k.Fm({threadId:b}))},[g,b]);let v=(0,o.d4)(e=>e.comments.typeahead),j=(0,o.d4)(e=>e.comments.editingComment),N=(0,o.d4)(e=>e.comments.activeThread?.id),S=(0,o.d4)(e=>e.comments.threads),M=N&&S[N]||null,E=M?.reply.messageMeta||[],{submitReply:F,updateMessage:D,submitEdit:B}=(t=(0,o.wA)(),i=(0,C.I_)().writeAPI,r=(0,C.GH)()?.threads,s=n.useCallback(e=>{i?!r||"loaded"!==r.status||r.data.find(t=>t.id===e.threadId)&&(e.onCommentValidationFailure=(a,n,o,r,l,s)=>k.dB(i,t,a,n,o,r,l,s,e.uuid,$.y),t(k.lV({...e,commentsWriteApi:i,commentsConfiguration:$.y,trackingContext:{feature:"web_quick_reply_screen"}}))):console.error("Calling submitReply with no write API")},[t,r,i]),{submitReply:s,updateMessage:n.useCallback(e=>{t(k.k7({threadId:b,messageMeta:e}))},[t,b]),submitEdit:n.useCallback((e,i)=>{t(k._v({comment:e,messageMeta:i}))},[t])}),O=(0,T._B)(),H=n.useRef(null),G=n.useRef(null),z=n.useRef(null),[K,W]=n.useState(null),[Q,Y]=n.useState(n.useRef(null)),X=n.useRef(null),J=0,Z=0,ee=0;X.current&&X.current.offsetParent&&(J=X.current.offsetWidth,Z=X.current.offsetLeft,ee=X.current.offsetParent.clientHeight-X.current.offsetTop);let et=e=>e||{x:0,y:0},ei=n.useRef(null);(0,n.useEffect)(()=>{ei.current&&ei.current.scrollToBottom()},[]);let ea=(0,n.useCallback)(e=>{g((0,x.to)({type:L.E,data:{comment:e,onConfirm:()=>{g(k.Mv({comment:e}))}}}))},[g]),en=[...new Set(d.map(e=>e.user.handle))],eo=d.find(e=>e.id===b);return eo?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:w.sx.flex1.$}),(0,a.jsx)(y.P,{className:"thread_view--bottomAnchoredScrollContainer--MFvWn",useBottomPinning:!0,ref:ei,enableScrollShadow:!0,children:(0,a.jsx)("div",{className:q,children:d.slice().map((e,t)=>(0,a.jsx)(R.I,{allowAttachments:!1,comment:e,dispatch:g,editingComment:j,editorOnClear:O.editorOnClear,editorOnInsert:O.editorOnInsert,editorRef:z,editorType:"comment-editor-thread",hideEmojiPicker:!1,hideReactions:!1,hideResolve:!1,hyperlinkLocation:K,index:t,isQuickReplyThreadView:!0,mentionables:_,mountInputFocused:!0,onDelete:ea,overflowMenuActions:h?[]:void 0,prevAuthor:0===t?null:d[t-1].user_id,setHyperlinkEditorRef:Y,setHyperlinkLocation:W,setIsEditorFocused:l.lQ,setResolved:l.lQ,showEditedIndicator:!!e.edited_at,submitEdit:B,thread:{comments:d,key:f,id:b},threadPosition:{x:0,y:0},typeahead:v,user:c,viewportPositionFromClientPosition:et},`thread-comment-${e.id}`))})}),(0,a.jsx)(P.K,{allowAttachments:!1,authorNames:en,className:V.MJ,dispatch:g,editingExistingComment:!1,editorOnClear:O.editorOnInsert,editorOnInsert:O.editorOnClear,editorRef:G,editorType:"comment-editor-reply",fileKey:f,hideEmojiPicker:!1,hyperlinkLocation:K,isDisabled:!1,isEmojiPickerDisabled:null!==j,mentionables:_,messageMeta:E,mountInputFocused:e.inFileBrowser??!1,onCancel:l.lQ,onSubmit:()=>{F({threadId:b,threadUuid:eo.uuid||void 0,uuid:(0,p.g)()})},placeholderText:(0,m.t)("comments.reply"),recordingKey:A.Dw.quickReply,replyContainerRef:X,setHyperlinkEditorRef:Y,setHyperlinkLocation:W,setIsEditorFocused:l.lQ,submitText:(0,m.t)("comments.reply"),threadId:b,threadPosition:null,typeahead:v,updateMessage:D,user:c,viewportPositionFromClientPosition:et}),(0,a.jsx)(I.rf,{decoratorsRef:H,onClear:O.onClear,onInsert:O.onInsert,width:J,direction:U.ri.UPWARDS,positionFromBottom:{left:Z,bottom:ee}})]}):null}},729221(e,t,i){i.d(t,{N:()=>d});var a=i(105652),n=i(645186),o=i(37760),r=i(140979),l=i(644350),s=i(818622);function d(){let e=a.useMemo(()=>(0,o.g)(),[]),t=(0,n.d4)(s.kY),i=(0,r.bc)(l.gfM,{cacheNonce:e});return a.useMemo(()=>{if("loaded"===i.status){let e=i.data?.lockClient;if(e)return e.lock}return t},[i,t])}},352393(e,t,i){i.d(t,{N:()=>n,j:()=>o});var a=i(688357);function n(e){let t=[];return e.forEach(e=>{e.content.forEach(e=>{let i=JSON.parse(e);i.nodeId&&t.push(i.nodeId)})}),t}function o(e,t){return[...new Set(e)].reduce((e,i)=>{let n=t(i),o=(a.Egt?.nodeIsPage(i)?n?.absoluteRenderBounds:n?.absoluteBoundingBox)??null;return e[i]=o?{x:o.x,y:o.y,width:o.w,height:o.h}:o,e},{})}},435065(e,t,i){if(i.d(t,{F:()=>n}),1464==i.j)var a=i(710127);function n(e,t,i){let{authedUsers:n,authedActiveCommunityProfile:o}=e,r=[],l=[];if(o?.associated_users)for(let e of o.associated_users){let t=n.byId[e.user_id];t&&(r.push(e.user_id),l.push(t))}return o?.team_id&&e.teams[o.team_id]?.org_id?[{teamId:null,orgId:e.teams[o.team_id].org_id,userId:e.user.id}]:o?.org_id||o?.team_id?[{teamId:o?.team_id??null,orgId:o?.org_id??null,userId:e.user.id}]:l.reduce((e,t)=>{let n=i.plansByUserId[t.id]||[];return e.concat(n.map(e=>(0,a.O)(e,t.id))||[])},[])}},271332(e,t,i){i.d(t,{n:()=>r});var a=i(645186),n=i(877757);let o=1464==i.j?["orgAdminSettings","billingGroupDashboard","orgDomainManagement","orgIdpManagement","abandonedDraftFiles","teamAdminConsole","seatRequests","licenseGroup"]:null;function r(){let e=(0,a.d4)(e=>e.selectedView);return!!o.some(t=>t===e.view)||"workspace"===e.view&&e.subView===n.V0.ADMIN}},507117(e,t,i){i.d(t,{K8:()=>o,QV:()=>r});var a,n=i(35212),o=1464==i.j?((a=o||{}).Connected="connected",a.NotConnected="not_connected",a):null;let r=new class{constructor(){this.GithubAppSetupSchemaValidator=(0,n.vh)(),this.GithubInstallationsMakeFileSchemaValidator=(0,n.vh)(),this.OrgGithubInstallationsSchemaValidator=(0,n.vh)(),this.LitmusGithubInstallationsSchemaValidator=(0,n.vh)(),this.GithubRepositoriesSchemaValidator=(0,n.vh)(),this.GithubCreateRepositorySchemaValidator=(0,n.vh)(),this.GithubUpdateRepositorySchemaValidator=(0,n.vh)(),this.GithubRepositorySchemaValidator=(0,n.vh)(),this.GithubDeleteMakeRepositoryMappingSchemaValidator=(0,n.vh)(),this.GithubInstallationAdminSchemaValidator=(0,n.vh)(),this.GithubInstallationDeleteSchemaValidator=(0,n.vh)()}startGithubAppSetup(e){return this.GithubAppSetupSchemaValidator.validate(async({xr:t})=>await t.post("/api/integrations/github-app/setup",n.td.toAPIParameters({plan_type:e.plan_type,plan_parent_id:e.plan_parent_id,request_context:e.request_context,request_context_id:e.request_context_id})))}getGithubInstallationsMakeFile(e){return this.GithubInstallationsMakeFileSchemaValidator.validate(async({xr:t})=>await t.get(`/api/integrations/github-app/figma-make/${e.file_key}/installations`))}getOrgGithubInstallations(e){return this.OrgGithubInstallationsSchemaValidator.validate(async({xr:t})=>await t.get(`/api/integrations/github-app/plans/${e.plan_type}/${e.parent_plan_id}/github-installations`,n.td.toAPIParameters(e)))}getLitmusGithubInstallations(e){return this.LitmusGithubInstallationsSchemaValidator.validate(async({xr:t})=>await t.get(`/api/integrations/github-app/litmus/plans/${e.plan_type}/${e.parent_plan_id}/github-installations`,n.td.toAPIParameters(e)))}getGithubRepositories(e){return this.GithubRepositoriesSchemaValidator.validate(async({xr:t})=>await t.get(`/api/integrations/github-app/plans/${e.plan_type}/${e.plan_parent_id}/github-installations/repositories`,n.td.toAPIParameters(e)))}adminCreateGithubRepository(e){return this.GithubCreateRepositorySchemaValidator.validate(async({xr:t})=>await t.post(`/api/integrations/github-app/plans/${e.plan_type}/${e.plan_parent_id}/github-installations/admin/repository`,n.td.toAPIParameters(e)))}adminUpdateGithubRepository(e){return this.GithubUpdateRepositorySchemaValidator.validate(async({xr:t})=>await t.put(`/api/integrations/github-app/plans/${e.plan_type}/${e.plan_parent_id}/github-installations/admin/repository`,n.td.toAPIParameters(e)))}getMakeGithubRepositoryMapping(e){return this.GithubRepositorySchemaValidator.validate(async({xr:t})=>await t.get(`/api/integrations/github-app/plans/${e.plan_type}/${e.plan_parent_id}/github-installations/admin/repository`,n.td.toAPIParameters(e)))}deleteMakeGithubRepositoryMapping(e){return this.GithubDeleteMakeRepositoryMappingSchemaValidator.validate(async({xr:t})=>await t.post(`/api/integrations/github-app/figma-make/${e.file_key}/remove_repository_mapping`,n.td.toAPIParameters(e)))}getGithubInstallationAdmin(e){return this.GithubInstallationAdminSchemaValidator.validate(async({xr:t})=>await t.get(`/api/integrations/github-app/plans/${e.plan_type}/${e.plan_parent_id}/installation/admin`))}deleteGithubInstallation(e){return this.GithubInstallationDeleteSchemaValidator.validate(async({xr:t})=>await t.del(`/api/integrations/github-app/installation/${e.installation_id}`))}}},613549(e,t,i){i.d(t,{R:()=>s,jn:()=>l});var a=i(140979),n=i(487817),o=i(644350),r=i(331850);function l(){let e=(0,r.T5)("useIsCurrentTeamProLocked").unwrapOr(null);return!!(e&&e.tier===n.Ag.PRO&&e?.planSubscription?.status===n.UX.SUSPENDED)}function s(e){var t;let i,l=(0,r.T5)("useIsEligbileForProTeamLockedRevampUI").unwrapOr(null),s=(t=e||l?.key.parentId,i=(0,a.bc)(o.TNJ,{id:t||""},{enabled:!!t}),!!i.unwrapOr({team:{hasPermission:!1}})?.team?.hasPermission);if(e&&l?.key.parentId!==e||!l||l.tier!==n.Ag.PRO)return!1;let d=s?[n.UX.UNPAID,n.UX.SUSPENDED]:[n.UX.SUSPENDED],c=l?.planSubscription?.status;return!!c&&!!d.includes(c)}},796182(e,t,i){i.d(t,{pG:()=>c,rw:()=>u});var a=i(239976),n=i(105652),o=i(564186),r=i(813377);class l extends o.o{constructor(){super(...arguments),this.styleOverrides=()=>({base:r.zP})}}class s extends o.o{constructor(){super(...arguments),this.styleOverrides=()=>({base:r.NQ,selected:r.xW})}}class d extends n.PureComponent{constructor(e){super(e),this.getTabClassWithStyling=()=>"adminSettings"===this.props.variant?s:l}render(){let e=this.getTabClassWithStyling();return(0,a.jsx)(e,{tab:this.props.tab,selectedTab:this.props.selectedTab,onClick:this.props.onClick,disabled:this.props.disabled,tooltipText:this.props.tooltipText,showTooltipWhenDisabled:this.props.showTooltipWhenDisabled,dataText:this.props.dataText,children:(0,a.jsx)("span",{className:r.Y1,"data-onboarding-key":this.props["data-onboarding-key"],children:this.props.children})})}}let c=d.name;function u(){return d}},197684(e,t,i){i.d(t,{J:()=>r});var a=i(239976),n=i(105652),o=i(859978);let r=n.forwardRef(function({children:e,...t},i){return(0,a.jsx)(o.E,{...t,ref:i,className:"icon_button_32--iconButton--E0ZHG",children:(0,a.jsx)("span",{"aria-hidden":!0,className:"icon_button_32--icon---5uYV",children:e})})})},99305(e,t,i){i.d(t,{H:()=>o});var a=i(105652),n=i(916290);let o=a.createContext({onClick:()=>!1,toggleQuickReply:n.lQ,onMouseMove:n.lQ,onRemove:n.lQ,inDesktopTray:!1})},27521(e,t,i){i.d(t,{IP:()=>e3,e8:()=>e4,ql:()=>e7,fd:()=>a,he:()=>e6});var a,n=i(239976),o=i(105652),r=i(645186),l=i(130729),s=i(622063),d=i(739565),c=i(859978),u=i(850159),m=i(335127),p=i(224542),_=i.n(p),h=i(195784),f=i(921282),b=i(447848),g=i(436174),y=i(714174),v=i(198788),w=i(116682),x=i(86057),k=i(497544),C=i(613629),j=i(898312),A=i(985373),I=i(358873),T=i(921840),N=i(402713),S=i(38900),R=i(865780),P=i(508295),M=i(389218),E=i(511225),F=i(761938),D=i(874937),B=i(471532),O=i(576537),U=i(732632),L=i(863088),$=i(459457),V=i(555235),q=i(129416),H=i(955721),G=i(838719),z=i(587047),K=i(883652),W=i(863825),Q=i(408493),Y=i(412427),X=i(750371),J=i(694151),Z=i(69806),ee=i(99305),et=i(854908);let ei="block_kit_row--rowContainer--e1-Q6",ea="block_kit_row--rowWidth--UCvuX",en="block_kit_row--rowBottom--xG8xA",eo="block_kit_row--metadataContainer--vz-3r",er="block_kit_row--usersContainerStructuredView--Cu-gt",el="block_kit_row--quickReplyChevronContainerBase---hFMz",es="block_kit_row--quickReplyChevronContainerDesktop--mircq block_kit_row--quickReplyChevronContainerBase---hFMz",ed="block_kit_row--imagePreview--UQE30";function ec(e){return`notification-${e.notification_id}`}function eu(e){return(0,n.jsx)("span",{className:"block_kit_row--htmlTextBlock--tGKuu",dangerouslySetInnerHTML:{__html:(0,z.p)(e.block.html_text)}})}function em(e){let t=(0,H.UF)(e.block.emoji_shortcode)[0];return t.meta?(0,n.jsx)("span",{className:"block_kit_row--emojiUnicode--eXGLS",children:t.unicode}):(0,n.jsx)(n.Fragment,{})}function ep(e){return e?e.map((e,t)=>"HtmlTextBlock"===e._block_type?(0,n.jsx)(eu,{block:e},t):(0,n.jsx)(em,{block:e},t)):[]}function e_(e){let{block:t,size:i}=e;return(0,n.jsx)(J.Ro,{entity:{...t,id:t.entity_id},size:i,hideFallbackInitial:!1,shape:t.shape.toUpperCase()})}function eh(e){let{block:t}=e;return(0,n.jsx)("div",{className:`${ed} thumbnail_DEPRECATED--tileThumbnail--NKIj6`,style:{background:`url(${(0,X.A)()})`},children:(0,n.jsx)("div",{className:"thumbnail_DEPRECATED--thumbnailContainer--OtJbl",style:{backgroundColor:(e=>{if(!e||0===e.alpha)return"transparent";let{red:t,green:i,blue:a,alpha:n}=e;return`rgba(${255*t|0}, ${255*i|0}, ${255*a|0}, ${n})`})(t.background_color)},children:(0,n.jsx)("div",{className:"thumbnail_DEPRECATED--thumbnail--5lUPd thumbnail_DEPRECATED--baseThumbnail--GkgtJ",style:{backgroundImage:`url(${t.img_url})`}})})})}function ef(e){let{block:t}=e;return(0,n.jsx)("div",{className:"block_kit_row--square--r4-LH",children:(0,n.jsx)("div",{className:ed,style:{backgroundImage:`url(${t.img_url})`}})})}function eb(e){let{avatars:t,icon:i}=e;return 0===t.length?null:t.length>1?(0,n.jsxs)("div",{className:er,children:[(0,n.jsx)("div",{className:"block_kit_row--secondaryUser--GfwAX",children:(0,n.jsx)(e_,{block:t[1],size:Y.Pf.MEDIUM})}),(0,n.jsx)("div",{className:"block_kit_row--primaryUser--gdi9o",children:(0,n.jsx)(e_,{block:t[0],size:Y.Pf.MEDIUM})}),i&&(0,n.jsx)(eg,{icon:i})]}):(0,n.jsxs)("div",{className:er,children:[(0,n.jsx)(e_,{block:t[0],size:Y.Pf.LARGE}),i&&(0,n.jsx)(eg,{icon:i})]})}function eg(e){let{icon:t}=e,i=new Set([(0,G.staticAssetWithUploadsPath)("fc8b3d0c889b51bd8800945089e8b473ff4d619d")]);return(0,n.jsx)("div",{className:"block_kit_row--icon--yvc2A",children:"ImageThumbnailBlock"===t._block_type?(0,n.jsx)("img",{className:`block_kit_row--iconImg--MdORE ${!i.has(t.img_url)?"block_kit_row--iconInvert--tcrGj":""} `,src:t.img_url,alt:""}):"ReacjiBlock"===t._block_type?(0,n.jsx)(em,{block:t}):"AvatarBlock"===t._block_type?(0,n.jsx)(e_,{block:t,size:Y.Pf.SMALL16}):void 0})}function ey(e){let t=(0,r.wA)(),{block:i,callbacks:a,isPrimary:o=!0,isDisabled:l,setIsDisabled:s}=e,d=async e=>{try{s(!0);let n=(await a.buildNotificationActionRequest(i.notification_action)).data.meta.updated_notification_blob;e&&t(C.F.enqueue({message:e,error:!1,role:"status"})),i.hide_after_action?a.hideNotification():(a.followLinkIfPossible(),n&&a.updateNotification(n.notification_id,n))}catch(a){let e=a.message||("resolve"===i.notification_action?(0,u.t)("user_notification.an_error_occurred_while_clicking_this_notification"):(0,u.t)("user_notification.an_error_occurred_while_removing_this_notification"));t(W.s.error(e))}finally{s(!1)}},c=ep([i.text]);return(0,n.jsx)(U.$n,{width:"fill",variant:o?"primary":"secondary",onClick:()=>{d(i.screenreader_action_success_announcement)},disabled:l,"aria-describedby":e.describedById,children:c})}function ev(e){let{block:t,actionBlockCallbacks:i,describedById:a}=e,[r,l]=o.useState(!1);return(0,n.jsxs)("div",{className:en,children:[(0,n.jsx)(ey,{block:t.secondary_action,callbacks:i,isPrimary:!1,isDisabled:r,setIsDisabled:l,describedById:a}),(0,n.jsx)(ey,{block:t.primary_action,callbacks:i,isPrimary:!0,isDisabled:r,setIsDisabled:l,describedById:a})]})}function ew(e){let{block:t,plan:i,shouldShowChevron:a,userLastViewedTimestamp:o,inDesktopTray:r,openQuickReply:l}=e;switch(t._block_type){case"BodyAndThumbnailBlock":return(0,n.jsx)(ex,{block:t,plan:i,shouldShowChevron:a});case"SplitlineTitleAndBodyBlock":return(0,n.jsx)(ek,{block:t,shouldShowChevron:a,userLastViewedTimestamp:o,inDesktopTray:r,openQuickReply:l})}}function ex(e){let{block:t,plan:i,shouldShowChevron:a}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"block_kit_row--contentContainer--mCC0g text--fontPos11--rO47d text--_fontBase--VaHfk",children:(0,n.jsxs)("div",{className:"block_kit_row--content--GeQID",children:[(0,n.jsx)("div",{children:ep(t.title)}),(0,n.jsxs)("div",{className:eo,children:[(0,n.jsxs)("div",{className:"block_kit_row--textContainer---LLlR",children:[t.description&&(0,n.jsx)("div",{className:"block_kit_row--notificationDescription--SgSPD ellipsis--ellipsisAfter3Lines--eBD0M ellipsis--_ellipsisAfterNLines--5f-ox",children:ep(t.description)}),(0,n.jsxs)("div",{className:"block_kit_row--fromNow--Mp-be",children:[i&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z.H,{entityId:i.id.toString(),entityName:i.name,imgUrl:i.img_url||void 0}),(0,E.gN)(i.name,21),(0,n.jsx)("div",{className:"block_kit_row--planDivider--pr3-5",children:"\xb7"})]}),(0,n.jsx)(K.h1,{date:t.created_at,style:"short"})]})]}),a&&(0,n.jsx)("div",{className:"block_kit_row--quickReplyChevron--79tbi",children:(0,n.jsx)(q.a,{})})]})]})}),(()=>{if(!t.thumbnail)return null;let e=t.thumbnail;switch(e._block_type){case"AvatarBlock":return(0,n.jsx)(e_,{block:e,size:Y.Pf.XLARGE});case"ImageThumbnailBlock":return(0,n.jsx)(ef,{block:e});case"FileThumbnailBlock":return(0,n.jsx)(eh,{block:e})}})()]})}function ek(e){let{block:t,shouldShowChevron:i,userLastViewedTimestamp:a,inDesktopTray:o,openQuickReply:r}=e;return(0,n.jsxs)("div",{className:"block_kit_row--contentContainerRevamp--4-XsW text--fontPos11--rO47d text--_fontBase--VaHfk",children:[(0,n.jsxs)("div",{className:"block_kit_row--titleAndTimestamp--oAOqq",children:[(0,n.jsx)("div",{className:"block_kit_row--title--wN-Cx",children:ep(t.title)}),(0,n.jsx)(eR,{createdAt:t.created_at,lastSeenTimestamp:a})]}),(0,n.jsxs)("div",{className:eo,children:[(0,n.jsx)("div",{className:"block_kit_row--subtitle--vq-x-",children:ep(t.subtitle)}),t.description&&(0,n.jsx)("div",{className:"block_kit_row--notificationDescriptionStructuredView--XX-Rw ellipsis--ellipsisAfter3Lines--eBD0M ellipsis--_ellipsisAfterNLines--5f-ox",children:ep(t.description)}),i&&r&&(0,n.jsx)("div",{className:_()(o?es:el,"block_kit_row--quickReplyGradient--AHjB2")})]})]})}function eC(e){let{notification:t}=e,i=(0,u.t)("user_notifications.unread_notifcation_sr");return(0,n.jsxs)("div",{className:_()("block_kit_row--rowTop--ZJJFO",ea),id:ec(t),children:[t.is_unread?(0,n.jsx)("div",{className:"block_kit_row--unreadDotStructuredView--lGcxO"}):null,(0,n.jsx)(eb,{avatars:t.avatars,icon:t.icon}),t.is_unread?(0,n.jsx)(L.E,{children:i}):null,e.children]})}function ej(e){let{attachment:t,notification:i,dontShowPlanIcon:a}=e;return(0,n.jsx)(eC,{notification:i,children:(0,n.jsx)(ew,{block:t.body,plan:!0===a?void 0:i.plan,userLastViewedTimestamp:i.filters.user_last_viewed_timestamp})})}function eA(e){let{attachment:t,notification:i,dontShowPlanIcon:a,openQuickReply:r}=e,{inDesktopTray:l}=o.useContext(ee.H);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)($.hE,{as:"span",children:(0,n.jsx)(eC,{notification:i,children:(0,n.jsx)(ew,{block:t.body,plan:!0===a?void 0:i.plan,userLastViewedTimestamp:i.filters.user_last_viewed_timestamp,inDesktopTray:l,shouldShowChevron:(0,et.UC)(i),openQuickReply:r})})}),(0,et.UC)(i)&&r&&(0,n.jsx)("div",{className:l?es:el,children:(0,n.jsx)($.HG,{children:(0,n.jsx)(V.K,{onClick:r,"data-testid":"quick-reply-chevron","aria-label":(0,u.t)("user_notifications.open_quickreply"),children:(0,n.jsx)(q.a,{})})})})]})}function eI(e){let{attachment:t,notification:i,actionBlockCallbacks:a}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eC,{notification:i,children:(0,n.jsx)(ew,{block:t.body,plan:i.plan,userLastViewedTimestamp:i.filters.user_last_viewed_timestamp})}),(0,n.jsx)(ev,{block:t.actions,actionBlockCallbacks:a,describedById:ec(i)})]})}function eT(e){let t=(0,r.wA)(),{block:i,isPrimary:a,markNotificationAsRead:o,followLinkOnClick:l}=e,s=ep([i.text]);return(0,n.jsx)(U.$n,{width:"fill",variant:a?"primary":"secondary",onClick:()=>{i.screenreader_action_success_announcement&&t(C.F.enqueue({message:i.screenreader_action_success_announcement,error:!1,role:"status"})),o(),l({overrideHref:i.href})},"aria-describedby":e.describedById,children:s})}function eN(e){let{block:t,describedById:i,markNotificationAsRead:a,followLinkOnClick:o}=e;return(0,n.jsxs)("div",{className:en,children:[(0,n.jsx)(eT,{block:t.secondary_button,isPrimary:!1,describedById:i,markNotificationAsRead:a,followLinkOnClick:o}),(0,n.jsx)(eT,{block:t.primary_button,isPrimary:!0,describedById:i,markNotificationAsRead:a,followLinkOnClick:o})]})}function eS(e){let{attachment:t,notification:i,markNotificationAsRead:a,followLinkOnClick:o}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eC,{notification:i,children:(0,n.jsx)(ew,{block:t.body,plan:i.plan,userLastViewedTimestamp:i.filters.user_last_viewed_timestamp})}),(0,n.jsx)(eN,{block:t.button_set,describedById:ec(i),markNotificationAsRead:a,followLinkOnClick:o})]})}function eR(e){let{createdAt:t,lastSeenTimestamp:i}=e,a=eP(t,i),o=(0,K.Ak)(t,"narrow");if("today"!==a&&"new"!==a){var r;let e,i=new Date(t),a={};r=i,(e=new Date).setDate(e.getDate()-365),a=r>=e?{month:"short",day:"numeric"}:{month:"short",day:"numeric",year:"numeric"},o=new Intl.DateTimeFormat((0,Q.Gq)().getPrimaryLocale(!1),a).format(i)}return(0,n.jsx)("div",{className:"block_kit_row--timestamp--gtrx5",children:o})}function eP(e,t){var i;let a=new Date(e),n=new Date,o=new Date(n);if(o.setDate(n.getDate()-1),t&&new Date(t)<a)return"new";if(eM(a,n))return"today";if(eM(a,o))return"yesterday";if(a>=new Date((i=n).getFullYear(),i.getMonth(),i.getDate()-7))return"last_week";return"older"}function eM(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}let eE={new:(0,u.tx)("user_notifications.new"),today:(0,u.tx)("user_notifications.today"),yesterday:(0,u.tx)("user_notifications.yesterday"),last_week:(0,u.tx)("user_notifications.last_7_days"),older:(0,u.tx)("user_notifications.older")},eF=new Set(["BuzzApprovalRequestCreatedNotif"]);function eD(e){return!!eF.has(e.notification_type)||e.preferred_attachments.length>0&&"ActionableAttachment"===e.preferred_attachments[0]._block_type}let eB={actionable:(0,u.tx)("user_notifications.pending"),actioned:(0,u.tx)("user_notifications.done")};var eO=i(523924),eU=i(181645),eL=i(42053),e$=i(75130);function eV(e){let t=e.preferred_attachments.find(e=>e$.p.BlockKit.Block.ATTACHMENT_TYPES.has(e._block_type));if(void 0===t)throw Error(`Unable to render attachment. Hiding notification ${e.notification_id}`);return t}function eq(e){var t;let i,a=(0,r.wA)(),[l,s]=(0,o.useState)(!1),d=(0,r.d4)(e=>e.selectedView.view),{onClick:m,toggleQuickReply:p,onMouseMove:h,onRemove:f,inDesktopTray:b}=o.useContext(ee.H),g=e.notification;o.useEffect(()=>()=>{f(g)},[f,g]);try{i=eV(e.notification)}catch(e){return console.error(`Unsupported Notification: ${e}`),null}let y=t=>{let i=d+"_quickreply";p(t,g,async()=>{try{await F.sr.markNotificationAsRead({notification_id:g.notification_id,currentView:i}),e.updateNotificationCallback(g.notification_id,{...g,is_unread:!1})}catch(e){(0,eL.x1)("Error marking notification as read",e)}})},v=e=>{h(e)},w=async t=>{(0,eU.sx)("file_browser_notification_clicked",{notification_id:g.notification_id,notification_type:g.notification_type,actionable:"ActionableAttachment"===i._block_type,selectedView:d,plan_filter:e.currentPlanFilter,notification_filter:e.currentNotificationFilter}),t.stopPropagation();let n=m(g);try{await x(),n||e.followLinkOnClickCallback()}catch(e){a(W.s.error((0,u.t)("user_notification.an_error_occurred_while_clicking_this_notification")))}},x=async()=>{await F.sr.markNotificationAsRead({notification_id:g.notification_id,currentView:d}),e.updateNotificationCallback(g.notification_id,{...g,is_unread:!1})},k=()=>{s(!0),e.onHide&&e.onHide()},C=(t,i=d)=>{switch(eU.az.trackDefinedEvent("notification.file_browser_notification_actioned",{notification_id:g.notification_id,notification_type:g.notification_type,notification_action:t,selectedView:d,plan_filter:e.currentPlanFilter||void 0,notification_filter:e.currentNotificationFilter}),t){case"resolve":return F.sr.acceptNotification({notification_id:g.notification_id,currentView:i});case"reject":return F.sr.rejectNotification({notification_id:g.notification_id,currentView:i});default:(0,eO.xb)(t)}},j=(t,i,a)=>{try{switch(t._block_type){case"ActionableAttachment":{let a={updateNotification:e.updateNotificationCallback,hideNotification:k,followLinkIfPossible:e.followLinkOnClickCallback,buildNotificationActionRequest:C};return(0,n.jsx)(eI,{attachment:t,notification:i,actionBlockCallbacks:a})}case"ClientActionableAttachment":return(0,n.jsx)(eA,{attachment:t,notification:i,openQuickReply:a});case"CtaAttachment":return(0,n.jsx)(eS,{attachment:t,notification:i,followLinkOnClick:e.followLinkOnClickCallback,markNotificationAsRead:x});case"BodyAndThumbnailAttachment":case"BodyAttachment":return(0,n.jsx)(ej,{attachment:t,notification:i,dontShowPlanIcon:e.dontShowPlanIcon})}}catch(e){console.error(`Unable to render attachment: ${t}`),k()}},A="ActionableAttachment"===(t=i)._block_type||"CtaAttachment"===t._block_type?(0,n.jsx)("article",{className:ei,onMouseMove:v,children:j(t,g)}):"ClientActionableAttachment"===t._block_type?(0,n.jsxs)($.bL,{className:ei,children:[(0,n.jsx)($.O6,{className:"block_kit_row--clientActionableRowFocus--KpScN",onClick:w,onMouseEnter:b?void 0:y,onMouseMove:v,"data-testId":"client-actionable-button",role:"link"}),j(t,g,y)??(0,n.jsx)(n.Fragment,{})]}):(0,n.jsx)(c.E,{className:_()(ei,ea),onMouseEnter:b?void 0:y,onMouseMove:v,role:"link",onClick:w,children:j(t,g)});return!l&&A||null}var eH=i(916290),eG=i(185805),ez=i(741542),eK=i(947406),eW=i(129836),eQ=i(354991),eY=i(74970),eX=i(94241);let eJ=class e{constructor(){this.circularBuffer=new eK.C(e.BUFFER_CAPACITY),this.lastTimestamp=0}clear(){this.circularBuffer.clear()}push(t,i){i-this.lastTimestamp>e.THROTTLE_DURATION_MS&&(this.circularBuffer.push(t),this.lastTimestamp=i)}getLocation50msAgo(){let e=this.circularBuffer.toArray();return e.length>0?e[0]:new eQ.Mi(window.innerWidth,window.innerHeight)}};function eZ(e){let[t,i]=(0,o.useState)(null),[a,r]=(0,o.useState)(0),l=(0,eX.q5)(),s=o.useRef(eH.lQ),d=o.useRef(eH.lQ),c=o.useRef(null),u=o.useRef(null),m=(0,et.zr)(l,t),p=o.useRef({notificationId:"",mouseLocationHistory:new eJ,scheduledShowQuickReply:void 0,scheduledMarkAsRead:void 0});(0,o.useEffect)(()=>{u.current&&u.current.addEventListener("mouseover",e=>{clearTimeout(p.current?.scheduledShowQuickReply)})},[t]);let _=o.useMemo(()=>{function e(e,t,a){let n=window.innerWidth>900&&window.innerHeight>650;p.current.notificationId=e.notification_id,n&&(0,et.UC)(e)?(i((0,et.AS)(e)),r(t),s.current=a):(i(null),s.current=eH.lQ),p.current.mouseLocationHistory.clear()}return{onClick:e=>!1,toggleQuickReply:(t,i,a)=>{let n=!1;if(i.notification_id!==p.current.notificationId&&u.current&&t instanceof MouseEvent){let e=u.current.getBoundingClientRect(),i=new eQ.Mi(e.left,e.top),a=new eQ.Mi(e.left,e.bottom),o=[p.current.mouseLocationHistory.getLocation50msAgo(),i,a];n=(0,eW.y)(new eQ.Mi(t.clientX,t.clientY),o)}let o=t.target;if(n)clearTimeout(p.current?.scheduledShowQuickReply),p.current&&(p.current.scheduledShowQuickReply=setTimeout(()=>{e(i,o.getBoundingClientRect().bottom,a)},500));else clearTimeout(p.current?.scheduledShowQuickReply),e(i,o.getBoundingClientRect().bottom,a)},onMouseMove:e=>{p.current.mouseLocationHistory.push(new eQ.Mi(e.clientX,e.clientY),e.timeStamp)},onRemove:e=>{e.notification_id===p.current.notificationId&&i(null)},inDesktopTray:!1}},[u]);if(!(0,ez.getFeatureFlags)().desktop_quickreply_filebrowser)return(0,n.jsx)(n.Fragment,{children:e.children});let h=Math.max(0,a-(c.current?.getBoundingClientRect().y??0)-(u.current?.getBoundingClientRect().height??640));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"quick_reply_switcher--hoverContainer--06-L-",ref:c,children:t&&!m&&(0,n.jsx)("div",{className:"quick_reply_switcher--quickReplyContainer--CWkQI","data-testid":"quick-reply-container",style:{top:h,maxHeight:640,minHeight:450},onMouseEnter:()=>{clearTimeout(p.current?.scheduledMarkAsRead),p.current.scheduledMarkAsRead=setTimeout(()=>{d.current=s.current},1e3)},onMouseLeave:()=>{clearTimeout(p.current?.scheduledMarkAsRead),d.current(),d.current=eH.lQ,s.current=eH.lQ},children:(0,n.jsx)(eG.i,{children:(0,n.jsx)(eY.d,{quickReplyInfo:t,onClose:()=>i(null),fileBrowser:!0,ref:u})})})}),(0,n.jsx)(ee.H.Provider,{value:_,children:e.children})]})}eJ.BUFFER_CAPACITY=10,eJ.DESIRED_DURATION_MS=50,eJ.THROTTLE_DURATION_MS=eJ.DESIRED_DURATION_MS/eJ.BUFFER_CAPACITY;let e0="user_notifications_dropdown--arrowRight--sAQvV",e1="user_notifications_dropdown--dropdownContainerEmptyState--k5Fhh user_notifications_dropdown--dropdownContainer--W42re text--fontPos11--rO47d text--_fontBase--VaHfk",e5="user_notifications_dropdown--dateHeader--Z3pNH",e2="user_notifications_dropdown--markAllReadButton--l4S7s text--fontPos11--rO47d text--_fontBase--VaHfk";function e7(e,t){let i=(0,r.wA)(),a=(0,r.d4)(e=>e.user.id),n=(0,r.d4)(e=>e.user.community_profile_id),s=(0,r.d4)(e=>e.authedUsers.byId[a]?.plans),d=o.useMemo(()=>void 0!==s&&(new Map(s.map(e=>[e.plan_id,e.is_org])).get(t)||!1),[s,t]),c=(0,r.d4)(e=>e.userNotifications.communityProfileBellStates),m=(0,r.d4)(e=>e.selectedView.view),[p,_]=(0,o.useState)(()=>new Map),[h,b]=(0,o.useState)(!0),g=(0,y.F)(c);o.useEffect(()=>{let o=(0,l.s)(()=>{e?n&&(g.current[n]&&i((0,E.X2)({isBellStateHigh:!1,userInitiated:!0,profileId:n})),F.sr.getCommunityServerDriven({currentView:m}).then(({data:e})=>{v(e.meta)}).catch(e=>{i(C.F.enqueue({message:(0,u.t)("user_notification.an_error_occurred_while_fetching_your_community_notifications"),type:"user-notification",error:!0})),i(A.oB())})):((0,E.Zo)(!1,E.td,a),F.sr.getServerDrivenPlan({currentPlanId:t,currentView:m,isPlanOrg:d}).then(({data:e})=>{v(e.meta)}).catch(e=>{i(C.F.enqueue({message:(0,u.t)("user_notification.an_error_occurred_while_fetching_your_notifications"),type:"user-notification",error:!0})),i(A.oB())}))},800,!0);b(!0),o()},[t,g,m,i,e,d,n,a]);let v=e=>{let t=new Map,i=!1;e.forEach(e=>{t.set(e.notification_id,e),!i&&e.filters.is_priority&&(i=!0)}),_(t),b(!1)};return{notificationFeedMap:p,isFetchingNotifications:h,markAllAsReadFn:()=>{(e?w.Ay.post("/api/user_notifications/community/mark_read",{currentView:m,source:f.S8?"desktopbell":"web"}):w.Ay.post("/api/user_notifications/mark_read/plan",{current_plan_id:t,currentView:m,is_plan_org:d,source:f.S8?"desktopbell":"web"})).then(()=>{_(new Map(Array.from(p,([e,t])=>(t.is_unread=!1,[e,t]))))}).catch(()=>{i(C.F.enqueue({message:(0,u.t)("user_notification.an_error_occurred_marking_all_as_read"),type:"user-notification",error:!0}))})},updateNotification:(e,t)=>{_(new Map(p.set(e,t)))}}}function e6(e,t){return e.filter(e=>!t.includes(e.notification_id))}function e4(e){return e.some(e=>e.filters.is_priority)}function e3(e){let{inCommunity:t,containerClassName:i,arrowRight:r}=e,[l,s]=(0,o.useState)(E.td),{notificationFeedMap:d,isFetchingNotifications:c,markAllAsReadFn:u,updateNotification:m}=e7(!!t,l),p=o.useCallback(e=>{e===O.a&&(e=E.td),(0,I.FE)(e,"notifications",void 0),s(e)},[s]);return c?(0,n.jsxs)(a.Container,{classNameProp:_()(e1,i,{[e0]:r}),children:[(0,n.jsx)(a.Header,{selectedPlan:l,onPlanFilterUpdate:p,inCommunity:!!t,inDesktopTray:!1}),(0,n.jsx)(a.LoadingFeed,{})]}):(0,n.jsx)(e8,{...e,selectedPlan:l,planFilterFn:p,notificationFeedMap:d,markAllAsReadFn:u,updateNotification:m})}function e8({containerClassName:e,arrowRight:t,inCommunity:i,selectedPlan:r,planFilterFn:l,notificationFeedMap:d,markAllAsReadFn:c,updateNotification:u}){let[p,f]=(0,o.useState)([]),b=r===E.td?O.a:r,g=e6([...d.values()],p),y=e4(g),v=(0,E.I5)(g),[w,x,k]=s.t.useTabs({all:!0,priority:y,unread:!0},{defaultActive:()=>"all"}),C=(0,m.ZC)(k.activeTab),j=(0,E.RH)(g);o.useEffect(()=>{k.activeTab!==C&&(0,h.Cu)({filter_type:k.activeTab},"user_notifications_filter_clicked")},[C,k.activeTab,v,j]);let A=o.useMemo(()=>g.filter(e=>e.filters.is_priority),[g]),I=o.useMemo(()=>g.filter(e=>e.is_unread),[g]),T=e=>(0,n.jsx)(a.Feed,{notifications:e,currentPlanFilter:b,currentNotificationFilter:k.activeTab,hiddenNotificationIds:p,setHiddenNotificationIds:f,inCommunity:i,fillParent:!1,updateNotificationCallback:u});return(0,n.jsx)(a.Container,{classNameProp:_()(0!==d.size?"user_notifications_dropdown--dropdownContainer--W42re text--fontPos11--rO47d text--_fontBase--VaHfk":e1,e,{[e0]:t}),children:(0,n.jsxs)(eZ,{children:[(0,n.jsx)(a.Header,{selectedPlan:r,onPlanFilterUpdate:e=>l(e),inCommunity:!!i,inDesktopTray:!1}),(0,n.jsx)(a.FilterToggle,{notificationFilter:k.activeTab,toggleNotificationFilter:e=>{(0,h.Cu)({filter_type:e},"user_notifications_filter_clicked")},notifications:g,markAllAsReadFn:c,tabManager:k,tabPropsMap:w}),(0,n.jsx)(s.t.TabPanel,{...x.all,children:T(g)}),(0,n.jsx)(s.t.TabPanel,{...x.priority,children:T(A)}),(0,n.jsx)(s.t.TabPanel,{...x.unread,children:T(I)})]})})}var e9=a||(a={});function te(e){return(0,n.jsx)("h3",{className:e5,children:eE[e.notificationDateGroup]})}function tt(e){return(0,n.jsx)("h3",{className:e5,children:eB[e.notificationPriorityGroup]})}function ti(e){return e.some(e=>e.is_unread)}e9.Container=function({children:e,classNameProp:t}){return(0,n.jsx)(d.o,{eventListeners:["onClick","onMouseDown"],children:(0,n.jsx)("div",{className:t,"data-onboarding-key":B.fD,children:e})})},e9.LoadingFeed=function(){return(0,n.jsx)("div",{className:"user_notifications_dropdown--loadingContainer--EqjyM",children:(0,n.jsx)(k.k,{})})},e9.Feed=function(e){let t=(0,P.Pc)(),i=(0,r.d4)(e=>t?e.authedUsers.byId[t.id]?.plans:null),a=(0,r.Pj)(),l=(0,r.wA)(),s=(0,R.sZ)(),{Sprig:d}=(0,v.A)(),c=!1;if(t&&!e.inCommunity&&i?.length===1&&(c=!0,e.currentPlanFilter===O.a)){let t=i[0].plan_id;for(let i of e.notifications)if(i.plan?.id.toString()!==t){c=!1;break}}let m=o.useCallback(t=>i=>{let n=i?.overrideHref||t.deeplink?.href;if(!n)return;let o=new URL(n),r=o.pathname;if("UserGroupMemberAddedNotif"===t.notification_type){let e=o.searchParams.get("user_group_id");e&&(l(A.oB()),l(S.to({type:D.y,data:{userGroupId:e}})));return}if(r.includes("project")){let t=r.split("project/")[1];t&&(0,T.x)("file_browser_folder_click",void 0,{folderId:t,selectedView:"notifications",planFilterId:e.currentPlanFilter===O.a?null:e.currentPlanFilter})}else if(r.includes("team")){let t=r.split("team/")[1];t&&(0,N._)("file_browser_team_click",void 0,{teamId:t,selectedView:"notifications",planFilterId:e.currentPlanFilter===O.a?null:e.currentPlanFilter})}else if((0,b.ek)(r)){let t=(0,b.zv)(r);t&&l(j.UN({fileKey:t,entrypoint:"notifications",currentPlanFilter:{planId:e.currentPlanFilter===O.a?void 0:e.currentPlanFilter||void 0},sprig:d}))}if(l(A.oB()),t.deeplink?.use_unsafe)g.Ay.unsafeRedirect(o.href,f.eD?void 0:"_blank");else if(e.inDesktopTray)g.Ay.redirect(o.href);else try{let e=(0,M.vU)(a.getState(),r);if("teamFeed"===e.view)return void(s&&t.plan?.id.toString()===s.id?l(A.sf(e)):g.Ay.redirect(o.href,f.eD?void 0:"_blank"));return void g.Ay.redirect(o.href,f.eD?void 0:"_blank")}catch{g.Ay.redirect(o.href,f.eD?void 0:"_blank")}},[l,e.currentPlanFilter,e.inDesktopTray,a,s,d]);if(0===e.notifications.length)return(0,n.jsx)("div",{className:"user_notifications_dropdown--emptyRow--TbCuQ",children:(0,u.tx)("user_notifications.dropdown.no_notifications")});{var p;let t,i;"priority"===e.currentNotificationFilter&&e.notifications.sort((e,t)=>Number(eD(t))-Number(eD(e)));let a=e.inCommunity?"user_notifications_dropdown--scrollContainer---Rell":"user_notifications_dropdown--scrollContainerWithPlan--zfiPd",r=eP((p=e.notifications)[0].preferred_attachments[0].body.created_at,p[0].filters.user_last_viewed_timestamp)===eP(p[p.length-1].preferred_attachments[0].body.created_at,p[0].filters.user_last_viewed_timestamp);return(0,n.jsx)(x.P,{className:e.fillParent?void 0:a,containerStyle:e.fillParent?{height:"100%"}:void 0,children:(0,n.jsx)("div",{children:e.notifications.map(a=>{var l;let s,d,u=null;return u="priority"===e.currentNotificationFilter?(s=null,(d=eD(l=a)?"actionable":"actioned")!==i&&(i=d,s=(0,n.jsx)(tt,{notificationPriorityGroup:d},`priority-${l.notification_id}`)),s):(e=>{let i,a=null;if(!r)try{i=eV(e);let o=eP(i.body.created_at,e.filters.user_last_viewed_timestamp);o!==t&&(t=o,a=(0,n.jsx)(te,{notificationDateGroup:o},`date-${e.notification_id}`))}catch(e){console.error("Skipping date header, unsupported notification")}return a})(a),(0,n.jsxs)(o.Fragment,{children:[u,(0,n.jsx)(eq,{notification:a,updateNotificationCallback:e.updateNotificationCallback,dontShowPlanIcon:c,currentPlanFilter:e.currentPlanFilter,currentNotificationFilter:e.currentNotificationFilter,inDesktopTray:e.inDesktopTray,onHide:()=>{var t;return t=a.notification_id,void e.setHiddenNotificationIds([...e.hiddenNotificationIds,t])},followLinkOnClickCallback:m(a)},`row-${a.notification_id}`)]},`row-container-${a.notification_id}`)})})})}},e9.UnreadBar=function(e){let t;return ti(e.notifications)?(0,n.jsxs)("div",{className:"user_notifications_dropdown--unreadToggleBar--QJMlN",children:[(t=e.notifications.reduce((e,t)=>e+Number(t.is_unread),0),(0,n.jsx)("div",{className:"user_notifications_dropdown--unread--n9TRK",children:(0,u.t)("user_notifications.unread_count",{unreadCount:t})})),ti(e.notifications)&&(0,n.jsx)(c.E,{onClick:e.markAllAsReadFn,className:e2,children:(0,u.tx)("user_notifications.dropdown.mark_all_as_read")})]}):null},e9.DateHeader=te,e9.PriorityHeader=tt,e9.Header=function(e){let t=!e.inDesktopTray;return(0,n.jsxs)("div",{className:"user_notifications_dropdown--header--1Z4T9",children:[e.inCommunity?(0,n.jsx)("div",{className:"user_notifications_dropdown--orgName--nbgTM ellipsis--ellipsis--70pHK text--fontPos11--rO47d text--_fontBase--VaHfk",children:(0,u.t)("user_notification.community_notifications")}):(0,n.jsx)(O.j,{currentPlanFilter:e.selectedPlan===E.td?O.a:e.selectedPlan,onPlanFilterUpdate:e.onPlanFilterUpdate,displaySettings:t}),e.children]})},e9.FilterToggle=function(e){let t,i,a=(0,n.jsxs)(s.t.TabStrip,{manager:e.tabManager,children:[(0,n.jsx)(s.t.Tab,{...e.tabPropsMap.all,children:(0,u.t)("user_notification.all")}),(0,n.jsx)(s.t.Tab,{...e.tabPropsMap.priority,children:0===(t=e.notifications.reduce((e,t)=>e+Number(eD(t)),0))?(0,u.t)("user_notifications.requests_empty"):(0,u.t)("user_notifications.requests_toggle_count",{actionableCount:t})}),(0,n.jsx)(s.t.Tab,{...e.tabPropsMap.unread,children:0===(i=e.notifications.reduce((e,t)=>e+Number(t.is_unread),0))?(0,u.t)("user_notifications.unread_empty"):(0,u.t)("user_notifications.unread_toggle_count",{unreadCount:i})})]});return(0,n.jsxs)("div",{className:"user_notifications_dropdown--filterToggleBar--hk648 user_notifications_dropdown--unreadToggleBar--QJMlN",children:[a,ti(e.notifications)&&(0,n.jsx)(c.E,{onClick:e.markAllAsReadFn,className:e2,children:(0,u.tx)("user_notifications.dropdown.mark_all_as_read")})]})}},576537(e,t,i){i.d(t,{a:()=>I,j:()=>T});var a=i(239976),n=i(105652),o=i(645186),r=i(147911),l=i(555235),s=i(68278),d=i(590859),c=i(859978),u=i(634193),m=i(850159),p=i(195784),_=i(824234),h=i(985373),f=i(38900),b=i(94241),g=i(508295),y=i(418754),v=i(511225),w=i(153645),x=i(328151),k=i(120061);let C="notifs_plan_filter--boldTitle--6AAsI",j="notifs_plan_filter--planFilterContainer--DKxKe";var A=i(354230);let I="ALL_PLANS_FILTER";function T(e){let{currentPlanFilter:t,onPlanFilterUpdate:i}=e,[T,N]=n.useState(I),S=(0,o.wA)(),R=(0,b.q5)(),P=(0,n.useRef)(null),{getTriggerProps:M,manager:E}=r.b(),F=(0,g.iZ)(),D=(0,o.d4)(e=>e.plans),B=(0,o.d4)(y.P),O=(0,o.d4)(e=>e.orgById),U=()=>{S(h.oB()),(0,p.Cu)({userId:F?.id,fileKey:R?.key,eventName:"Notification Settings Button Clicked"}),S(f.to({type:k.s,data:{tab:k.c.NOTIFICATIONS}}))};if(!F||!D||D.length<=1)return(0,a.jsxs)("div",{className:j,children:[(0,a.jsx)("h1",{className:C,children:(0,m.t)("user_notification.all_notifications")}),e.displaySettings&&D?.length===1&&(0,a.jsx)(l.K,{"aria-label":(0,m.t)("user_notifications.settings"),"data-dropdown-tooltip":(0,m.t)("user_notifications.settings"),"data-tooltip-type":x.Ib.TEXT,"data-tooltip-show-above":!0,onClick:U,children:(0,a.jsx)(u.n,{})})]});let L=D.map(e=>e.plan_id);L.unshift(I);let $=(e,t)=>e===I?(0,m.t)("user_notification.all_notifications"):t[e],V=D.reduce((e,t)=>{if("plan_type"in t){let i="";if(t.plan_type===w.O.ORG){let e=O[t.plan_id];i=e?.name??i}else{let e=B[t.plan_id];i=e?.name??i}e[t.plan_id]=i}else"name"in t&&(e[t.plan_id]=t.name);return e},{}),q=L.map(e=>(0,a.jsx)(s.CU,{value:e,children:$(e,V)},e));return(0,a.jsxs)("div",{className:j,ref:P,children:[(0,a.jsx)(d.nK,{children:(0,a.jsxs)(r.bL,{manager:E,children:[(0,a.jsxs)(c.E,{"aria-label":(0,m.t)("user_notifications.notif_filter_label",{planName:$(t,V)}),className:"notifs_plan_filter--dropdownButton--YQozm",...M(),children:[(0,a.jsx)("span",{className:[C,"notifs_plan_filter--autoTruncate--3lS3f ellipsis--ellipsis--70pHK"].join(" "),children:(0,v.gN)($(t,V),35)}),(0,a.jsx)(_.B,{svg:A.A,className:"notifs_plan_filter--chevronIcon--G7ev8"})]}),(0,a.jsx)(r.mc,{children:(0,a.jsx)(s.z6,{title:null,onChange:e=>{i(e),N(e)},value:T,children:q})})]})}),e.displaySettings&&(0,a.jsx)(l.K,{"aria-label":(0,m.t)("user_notifications.settings"),"data-dropdown-tooltip":(0,m.t)("user_notifications.settings"),"data-tooltip-type":x.Ib.TEXT,"data-tooltip-show-above":!0,onClick:U,children:(0,a.jsx)(u.n,{})})]})}},860857(e,t,i){i.d(t,{DG:()=>E,Kc:()=>S,OQ:()=>R,Zp:()=>T,dy:()=>M,in:()=>F,rS:()=>P});var a,n,o=i(105652),r=i(645186),l=i(701328),s=i.n(l),d=i(181645),c=i(668522),u=i(801236);if(2036!=i.j)var m=i(898312);var p=i(904511),_=i(927243);if(2036!=i.j)var h=i(435626);var f=i(865876),b=i(271044),g=i(352393),y=i(354621),v=i(83522);if(2036!=i.j)var w=i(487817);var x=i(886213),k=i(331850),C=i(355949);if(2036!=i.j)var j=i(785046);if(2036!=i.j)var A=i(930693);if(2036!=i.j)var I=i(708881);var T=2036!=i.j?((a=T||{}).TILE="tile",a.DETAIL_MODAL="detail",a):null;function N(e,t,i){return e===i&&t!==w.Xn.GUEST}function S(e,t){let i=`${location.origin}/files/${e}/feed-posts`;return t?.uuid&&(i+=`/${t.uuid}`),i}function R({fileVersionId:e,fileKey:t,startingNodeId:i},a){let n=(0,C.lD)({startingPointNodeId:i,versionId:e});n["redirect-src"]="feed",Object.assign(n,a);let o=Object.entries(n).map(([e,t])=>`${e}=${t}`).join("&");return`${location.origin}/proto/${t}?${o}`}function P(e,t,i){let a=(0,r.wA)(),n=t.find(e=>e.type===j.cM.NODE||e.type===j.cM.PROTOTYPE),l=(n?n.fileKey:void 0)||i;o.useEffect(()=>{a(_.ZN({file_key:l??void 0}))},[a,l]);let s=x.M4.useFile(l).data,c=(0,u.$E)(),p=o.useMemo(()=>s&&n&&n.type===j.cM.PROTOTYPE?u.y1.PROTOTYPE:s?c(s):void 0,[s,n,c]),h=s&&void 0!==p;return{fileData:s,fileIcon:p,fileLoaded:h,openFile:o.useCallback(()=>{if((0,d.sx)("Team Feed File Clicked",{postUuid:e}),n)if(n.type===j.cM.NODE){let t=(0,v.jN)({file:{key:n.fileKey},commentId:(0,A.iw)(e)});a(m.V3({url:t}))}else n.type===j.cM.PROTOTYPE&&a(m.V3({url:R(n)}));if(l){let e=(0,v.jN)({file:{key:l}});a(m.V3({url:e}))}},[a,n,e,l])}}var M=2036!=i.j?((n=M||{}).TILE="tile",n.DETAIL="detail",n):null;function E(e,t){let i=(0,r.wA)();return o.useCallback(()=>{(0,d.sx)("Team Feed Copy Link Clicked",{postUuid:e,source:t}),i(p.le({view:"teamFeed",postUuid:e}))},[i,e,t])}function F(e,t,i,a){let[n,r]=o.useState({}),[l,u]=o.useState({}),m=(0,y.eY)(),p=(0,k.D6)("useFeedPostInfo").unwrapOr(null),_=p?.key.type===w.h4.ORG_USER?p.planKey.parentId??void 0:void 0,v=p?.key.type===w.h4.ORG_USER?p.permission:void 0;return o.useEffect(()=>{if(e.errors&&e.errors.length){let t=JSON.stringify(e.errors.map(e=>({code:e.code,path:e.path,message:e.error?.message||""})));console.error(`Failed to load feed posts: ${t}`),(0,d.sx)("Livegraph Feed Post Comments Errors",{errors:t})}},[e.errors]),o.useMemo(()=>{if((0,b.y)()&&"loaded"===e.status&&e.data.file&&m?.get){let t=e.data.file.feedPosts,o=t.filter(e=>!!e.org&&!!v&&N(_,v,e.org.id)),d=(0,g.N)(o),c=i(d);Object.entries(c).every(([e,t])=>null===n[e]&&null===t||!!n[e]&&!!t&&n[e]===t)||r(c);let p=a(d,m?.get.bind(m),t);Object.entries(p).every(([e,t])=>{let i=l[e];return!!i&&s()(i,t)})||u(p)}},[e,m,i,a,v,_,n,l]),o.useMemo(()=>{if(!_)return(0,c.gB)([]);if("loaded"!==e.status)return e;if(!e.data.file)return(0,c.gB)([]);let i={},a=(e.data.file?.feedPosts||[]).sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()).filter(e=>!!e.org&&N(_,v,e.org.id)).map(e=>{let a=e.comments.map(e=>({id:`feed_comment_${e.id}`,uuid:e.uuid,key:"",parent_id:null,user_id:e.user.id,created_at:e.createdAt.toISOString(),resolved_at:null,deleted_at:null,message_meta:(0,f.o8)(e.messageMeta),client_meta:null,order_id:null,isUnread:!1,isPendingFromSinatra:!1,user:(0,f.CR)(e.user),feed_id:e.id,attachments:e.attachments,makeCommentContext:(0,c.Wk)(null)})),[o,...r]=(0,g.N)([e]);i[o]=i[o]+1||0;let s=n[o]??null,d=l[e.publicUuid]?.[o],u={};for(let t of r)n[t]===s&&(u[t]=l[e.publicUuid]?.[t]);let m=null,p=null;d&&(p={x:d.x+d.width,y:d.y},m={x:d.x,y:d.y+d.height});let _=(0,f.CR)(e.creator),b=(0,A.iw)(e.publicUuid),y=e.content.map(e=>JSON.parse(e)),{thumbnail:v,padImage:w,thumbnailBackground:x}=(0,I.i)(y,e.backgroundColor??void 0);return{id:b,uuid:"",key:e.fileKey||"",anchored:!1,selectionAnchorCanvasPosition:null,page:s,pageName:null,isActive:t===b,isPendingFromSinatra:!1,canvasPosition:p,boundingBoxAnchorCanvasPosition:m,comments:[{id:b,uuid:"",key:e.fileKey||"",parent_id:null,user_id:_.id,created_at:e.createdAt.toISOString(),resolved_at:null,deleted_at:null,message_meta:(0,f.o8)(e.descriptionMeta),client_meta:null,order_id:null,isUnread:!1,isPendingFromSinatra:!1,user:_,feed_id:e.id,makeCommentContext:(0,c.Wk)(null)},...a],messageMeta:[],attachments:[],isCanvasMention:!1,sidebarItemType:h.kT.FEED_POST,feedPostPublicUuid:e.publicUuid,feedPostTitle:e.title,feedPostThumbnail:v,feedPostThumbnailBackground:x,feedPostNumContent:e.content.length,padFeedPostThumbnail:w,otherBoundingBoxes:u,pinVerticalStagger:i[o]}});return(0,c.gB)(a)},[e,t,n,l,_,v])}},323931(e,t,i){i.d(t,{dV:()=>z});var a=i(239976),n=i(105652),o=i(645186),r=i(661391),l=i(859978),s=i(71239),d=i(297151),c=i(555355),u=i(878438),m=i(395227),p=i(635618),_=i(7e3),h=i(688357),f=i(491852),b=i(850159),g=i(350923),y=i(37760),v=i(224542),w=i.n(v),x=i(149778),k=i(865804),C=i(573598),j=i(99101),A=i(113116),I=i(687497),T=i(38900),N=i(936652),S=i(575425),R=i(865955),P=i(354621),M=i(508295),E=i(458983),F=i(113641),D=i(102607),B=i(512396),O=i(122051),U=i(392804),L=i(902869),$=i(833972);let V="edit_color_palette_modal--modalLabel--R2SPI text--fontPos11--rO47d text--_fontBase--VaHfk",q="edit_color_palette_modal--circleButton--5XzrZ";function H({color:e,setColor:t,index:i,isColorPickerOpen:n,setColorPickerOpen:o,removeColor:s,theme:d,dropperDisabled:c}){return(0,a.jsx)(U.v,{color:e,dropperDisabled:c,isOpen:n,onColorChange:t,onOpenChange:o,placement:"bottom",renderTrigger:t=>(0,a.jsxs)("div",{className:"edit_color_palette_modal--colorCircleOuter--803GZ",children:[(0,a.jsx)(r.u,{...t,"aria-label":(0,b.t)("whiteboard.colors.palette.hexadecimal",{hex:(0,x.colorToHex)(e)}),className:q,children:(0,a.jsx)(O.pt,{background:"light",paletteType:"base",selectionState:n?"selected":"unselected",size:"large",value:e},e+"-"+i)}),(0,a.jsx)(l.E,{className:w()({"edit_color_palette_modal--deleteColorButton--KNRme":!0,"edit_color_palette_modal--deleteColorButtonDisabled--78qNl":n}),onClick:()=>s(),"aria-label":(0,b.t)("whiteboard.color_palettes.modal.remove_color",{color_name:(0,b.t)("whiteboard.colors.palette.hexadecimal",{hex:(0,x.colorToHex)(e)})}),"data-testid":`delete-color-button-${i}`,children:(0,a.jsx)(p.A,{className:"edit_color_palette_modal--deleteColorIcon--d-4TT"})})]},"wrapper"+e+"-"+i),softDismiss:!0,theme:d})}function G({onSave:e,onCancel:t,palette:i,enableSubmitWithNoChanges:l,manager:m,isPaletteEyedropperActive:p,theme:f}){let v=(0,o.wA)(),[w,k]=n.useState(i?.name||""),[N,P]=(0,g.fp)($.Jq),F=n.useCallback(()=>-1!==N&&(P(-1),!0),[N,P]);(0,R.O1)(F,R.KD.OVERLAY);let U=n.useMemo(()=>i?.baseColors||(0,B.Vk)(),[i?.baseColors]),[G,K]=(0,g.fp)($.rN),W=(0,g.Xr)(D.Bw),Q=!(0,C.$K)(U,G)||l,[Y,X]=n.useState(!1);n.useEffect(()=>(P(-1),K(U),W(h.cxo.EDIT_PALETTE_MODAL),()=>{P(-1),K(U),W(h.cxo.SELECTION)}),[P,K,W,U]);let J=(0,o.d4)(e=>{let t=e.selectedView;return"fullscreen"!==t.view||t.editorType!==S.nT.Whiteboard}),Z=n.useCallback(e=>{K([...G,e])},[G,K]),ee=n.useCallback((e,t)=>{K([...G.slice(0,e),t,...G.slice(e+1)])},[G,K]),et=n.useCallback(e=>{v(T.$O({type:z.type,data:{palette:{uuid:e,name:w,baseColors:G},enableSubmitWithNoChanges:!0,theme:f}}))},[v,w,G,f]),ei=(0,E.cD)(),ea=(0,M.TA)(),en=(0,L.Bw)(),eo=n.useCallback(()=>{let t=G.some((e,t)=>G.some((i,a)=>t!==a&&(0,C.DA)(e,i)));if(X(t),t)return;let a=G.map(e=>(0,x.colorToHex)(e,1));if(w&&ea&&a.length){let t=i?.uuid||(0,y.g)();i?(0,$.NK)({name:w,teamId:ei,baseColors:a,uuid:t},v,()=>et(t)):((0,$.cl)({name:w,teamId:ei,uuid:t,baseColors:a,creatorId:ea,isTeamDefault:!1,canRead:!0},v,()=>et(t)),en(t,a.length,!0)),e()}},[G,w,ea,i,e,ei,v,et,en]),er=function(e){let t=(0,C.tK)(j.ol.MULTIPLAYER_PURPLE)||C.Uv;if(!e)return t;let i=(0,_.oB)(e),a=360*i.h,n={...i,h:(a+40)%360/360};return(0,_.In)(n)}(G.length>0?G[G.length-1]:null),el=G.length>=9,es=w&&w.trim()&&G.length>0&&(!i||Q||w!==i.name),ed=i?(0,b.t)("whiteboard.color_palettes.modal.edit_palette"):(0,b.t)("whiteboard.color_palettes.modal.create_palette");return(0,a.jsx)(s.bL,{width:"fit-content",height:"dynamic",manager:m,children:(0,a.jsxs)(d.vo,{children:[(0,a.jsx)(d.Y9,{children:(0,a.jsx)(d.hE,{children:ed})}),(0,a.jsxs)(d.nB,{style:{overflow:"visible"},children:[(0,a.jsx)(c.J,{htmlFor:"palette-name-input",className:V,children:(0,b.tx)("whiteboard.color_palettes.modal.name")}),(0,a.jsx)("div",{className:"edit_color_palette_modal--nameInput--w0zz2",children:(0,a.jsx)(u.p,{id:"palette-name-input",placeholder:(0,b.t)("whiteboard.color_palettes.modal.palette_name"),value:w||"",onChange:e=>k(e.slice(0,100)),size:"lg","data-testid":"palette-name-input"})}),(0,a.jsxs)("div",{className:"edit_color_palette_modal--colorsContainer--Y0HUV",children:[(0,a.jsx)("h3",{className:V,children:(0,b.tx)("whiteboard.color_palettes.modal.colors")}),(0,a.jsx)("p",{className:"edit_color_palette_modal--modalDescription--ZCWCF text--fontPos11--rO47d text--_fontBase--VaHfk",children:(0,b.tx)("whiteboard.color_palettes.modal.choose_up_to_9_colors")}),Y&&(0,a.jsx)("p",{className:"edit_color_palette_modal--modalDescriptionError--OnjHk text--fontPos11--rO47d text--_fontBase--VaHfk",children:(0,b.tx)("whiteboard.color_palettes.modal.duplicate_colors")}),(0,a.jsxs)("div",{className:"edit_color_palette_modal--colorPaletteContainer--dq5EX",children:[G.map((e,t)=>(0,a.jsx)(H,{color:e,setColor:e=>ee(t,e),index:t,isColorPickerOpen:!p&&N===t,setColorPickerOpen:e=>P(e?t:-1),removeColor:()=>{K([...G.slice(0,t),...G.slice(t+1)])},dropperDisabled:J,theme:f},"editbutton-"+e+"-"+t)),!el&&(0,a.jsx)(r.u,{"aria-label":(0,b.t)("whiteboard.color_palettes.modal.add_color"),"aria-haspopup":!0,"aria-expanded":!1,"data-testid":"add-color-button",className:q,onClick:()=>{P(G.length),Z(er)},children:(0,a.jsx)(O.HL,{size:"large",value:O.WW,swatchStyle:{boxShadow:"0px 0px 0px 1px rgba(0, 0, 0, 0.2) inset"},fallbackSvg:O.xY})})]})]})]}),(0,a.jsx)(d.wi,{children:(0,a.jsxs)(d.jk,{children:[(0,a.jsx)(I.E,{color:"secondary",children:(0,b.tx)("whiteboard.color_palettes.modal.palettes_visible_to_everyone")}),(0,a.jsx)(A.$z,{variant:"secondary",onClick:t,children:(0,b.tx)("whiteboard.color_palettes.modal.cancel")}),(0,a.jsx)(A.$z,{variant:"primary",disabled:!es,type:"submit",onClick:eo,"data-testid":"save-button",children:(0,b.tx)("whiteboard.color_palettes.modal.save_palette")})]})})]})})}let z=(0,N.Ju)(function({palette:e,theme:t,enableSubmitWithNoChanges:i,...r}){let l=(0,o.wA)(),s=(0,M.TA)(),d=(0,E.cD)(),c=m.hS({open:r.open,onClose:r.onClose}),u=(0,P.dH)(),p=(0,g.md)(D.Bw),_=u===f.NLJ.DROPPER_COLOR&&p===h.cxo.EDIT_PALETTE_MODAL,b=n.useCallback(()=>{l(T.Lo())},[l]);return(0,a.jsx)("div",{className:w()("edit_color_palette_modal--headerModalTransitionContainer--EDIvH",{"edit_color_palette_modal--hidden--bhTTI":_}),children:(0,a.jsx)(k.fu,{name:F.e0.FIGJAM_EDIT_PALETTE_MODAL,properties:{userId:s,teamId:d,type:e?"edit palette":"new palette"},children:(0,a.jsx)(G,{onSave:b,onCancel:b,palette:e,enableSubmitWithNoChanges:i,manager:c,isPaletteEyedropperActive:_,theme:t})})})},"EditColorPaletteModal")},756587(e,t,i){i.d(t,{j:()=>U});var a=i(239976),n=i(645186),o=i(395227),r=i(71239),l=i(297151),s=i(208650),d=i(555235),c=i(859035),u=i(519226),m=i(850159),p=i(865804),_=i(493094),h=i(227031),f=i(113116),b=i(497544),g=i(397383),y=i(38900),v=i(936652),w=i(243721),x=i(508295),k=i(644350),C=i(458983),j=i(622914),A=i(328151),I=i(113641),T=i(754305),N=i(833972),S=i(212001);let R=(0,v.Ju)(function({paletteUuid:e}){let t=(0,n.wA)();return(0,a.jsx)(T.yX,{size:300,confirmText:(0,m.t)("whiteboard.color_palettes.modal.delete_color_palette_button"),confirmationTitle:(0,m.t)("whiteboard.color_palettes.modal.delete_color_palette_confirmation_modal_title"),popStack:!0,destructive:!0,onConfirm:()=>{(0,N.RN)(e,t)},children:(0,a.jsx)("div",{className:S.jE,children:(0,m.tx)("whiteboard.color_palettes.modal.delete_color_palette_confirmation_modal_content")})})},"DeleteColorPaletteConfirmationModal");var P=i(512396),M=i(122051),E=i(902869),F=i(323931);let D=(0,v.Ju)(function({paletteName:e,paletteUuid:t}){let i=(0,n.wA)(),o=(0,C.cD)(),r=(0,n.d4)(e=>e.teams[o]?.name);return r||console.error("No team name found for team id",o),(0,a.jsx)(T.yX,{size:360,confirmationTitle:(0,m.t)("whiteboard.color_palettes.make_default_confirmation_modal.title"),confirmText:(0,m.t)("whiteboard.color_palettes.make_default_confirmation_modal.confirm_button"),content:(0,m.t)("whiteboard.color_palettes.make_default_confirmation_modal.description",{teamName:r,paletteName:e||(0,m.t)("whiteboard.color_palettes.make_default_confirmation_modal.this_palette")}),onConfirm:()=>{t===j.f?(0,N.In)(o,i):(0,N.dq)(o,t,i)},popStack:!0})},"MakePaletteTeamDefaultConfirmationModal");function B({showMakeDefaultButton:e,entryPoint:t,theme:i,...s}){let d=(0,x.TA)(),c=(0,C.cD)(),u=o.hS({open:s.open,onClose:s.onClose}),h=(0,n.wA)(),[g]=(0,_.IT)((0,k.iP2)({teamId:c}),{enabled:!!c});return(0,a.jsx)(p.fu,{name:I.e0.FIGJAM_MANAGE_PALETTES_MODAL,properties:{entryPoint:t,userId:d,teamId:c},children:(0,a.jsx)(r.bL,{width:"fit-content",height:"dynamic",manager:u,children:(0,a.jsxs)(l.vo,{children:[(0,a.jsx)(l.Y9,{children:(0,a.jsx)(l.hE,{children:(0,m.t)("whiteboard.color_palettes.manage_modal.color_palettes")})}),(0,a.jsxs)(l.nB,{padding:16,children:[(0,a.jsxs)("div",{className:"manage_color_palettes_modal--subheader--0tMxG",children:[(0,a.jsx)("div",{className:"manage_color_palettes_modal--manageText--Obimw",children:(0,m.tx)("whiteboard.color_palettes.manage_modal.manage_your_teams_color_palettes")}),(0,a.jsx)(f.$z,{variant:"primary",onClick:()=>{h(y.$O({type:F.dV.type,data:{theme:i}}))},"data-testid":"create-color-palette-button",children:(0,m.tx)("whiteboard.color_palettes.manage_modal.create_new_palette")})]}),(0,a.jsx)("div",{className:"manage_color_palettes_modal--paletteRowsOuter--5kxen","aria-busy":"loading"===g.status,children:"loaded"===g.status&&g.data.colorPalettesForTeam?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(O,{palette:{uuid:j.f,name:(0,m.t)("whiteboard.color_palettes.figjam_colors"),baseColors:(0,P.TS)("base").map(e=>w.z5.format(e)),isTeamDefault:g.data.colorPalettesForTeam.every(e=>!e.isTeamDefault)},theme:i,showMakeDefaultButton:e},j.f),g.data.colorPalettesForTeam.map(t=>(0,a.jsx)(O,{palette:t,theme:i,showMakeDefaultButton:e},t.uuid))]}):(0,a.jsx)(b.k,{size:"lg","data-testid":"loading-spinner"})})]})]})})})}function O({palette:e,theme:t,showMakeDefaultButton:i}){let o=(0,n.wA)(),r=e.uuid===j.f,l=e.name||(0,m.t)("whiteboard.color_palettes.unnamed_palette");return(0,a.jsxs)(g.Y,{width:"fill-parent",direction:"vertical",spacing:"4px",children:[(0,a.jsx)(g.Y,{direction:"horizontal",spacing:"8px",children:(0,a.jsxs)("h3",{children:[l,e.isTeamDefault&&(0,a.jsx)("span",{className:"manage_color_palettes_modal--badge--cRgyv",children:(0,a.jsx)(s.E,{variant:"brandOutline",children:(0,m.t)("whiteboard.color_palettes.manage_modal.default")})})]})}),(0,a.jsxs)(g.Y,{direction:"horizontal",width:"fill-parent",horizontalAlignItems:"space-between",children:[(0,a.jsx)(g.Y,{direction:"horizontal",width:"hug-contents",spacing:"0px",children:e.baseColors.map(e=>(0,a.jsx)(M.pt,{value:w.z5.parse(e),paletteType:"base",background:"light",role:"img",ariaLabel:(0,m.t)("whiteboard.colors.palette.hexadecimal",{hex:e})},e))}),(0,a.jsxs)(g.Y,{direction:"horizontal",width:"hug-contents",spacing:"8px",children:[!r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.K,{onClick:()=>{o(y.$O({type:F.dV.type,data:{palette:{uuid:e.uuid,name:e.name,baseColors:(0,E.$v)(e?.baseColors),isTeamDefault:e.isTeamDefault},theme:t}}))},"aria-label":(0,m.t)("whiteboard.color_palettes.modal.edit_named_palette_tooltip",{palette_name:l}),"data-testid":"edit-color-palette-button-"+e.uuid,"data-tooltip-type":A.Ib.TEXT,"data-tooltip":(0,m.t)("whiteboard.color_palettes.modal.edit_named_palette_tooltip",{palette_name:l}),children:(0,a.jsx)(c.C,{})}),(0,a.jsx)(d.K,{onClick:()=>{o(y.$O({type:R.type,data:{paletteUuid:e.uuid}}))},"aria-label":(0,m.t)("whiteboard.color_palettes.modal.delete_named_palette_tooltip",{palette_name:l}),"data-testid":"delete-color-palette-button-"+e.uuid,"data-tooltip-type":A.Ib.TEXT,"data-tooltip":(0,m.t)("whiteboard.color_palettes.modal.delete_named_palette_tooltip",{palette_name:l}),children:(0,a.jsx)(u.B,{})})]}),i&&(0,a.jsx)(f.$z,{variant:"secondary",disabled:e.isTeamDefault,onClick:()=>{o(y.$O({type:D.type,data:{paletteUuid:e.uuid,paletteName:e.name}}))},"data-testid":"make-palette-team-default-button-"+e.uuid,children:(0,m.tx)("whiteboard.color_palettes.modal.set_default")})]})]})]})}let U=(0,v.Ju)(function(e){return(0,a.jsx)(h.u9,{label:"ManageColorPalettesModal",children:(0,a.jsx)(B,{...e})})},"ManageColorPalettesModal")},419450(e,t,i){i.d(t,{J:()=>o});var a=i(105652),n=i(239976);let o=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24L",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M10.197 5a2 2 0 0 1 1.664.89L13.268 8H19a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2zM5 6a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-7a1 1 0 0 0-1-1h-6.268L11.03 6.445A1 1 0 0 0 10.197 6zm5.5 2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1z"})})})},316509(e,t,i){i.d(t,{Q:()=>o});var a=i(105652),n=i(239976);let o=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M7.5 6A1.5 1.5 0 0 0 6 7.5v1a.5.5 0 0 0 1 0v-1a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 0-1 0v1A1.5 1.5 0 0 0 7.5 18h9a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 16.5 6zm4.146 3.146a.5.5 0 0 1 .708 0l2.5 2.5a.5.5 0 0 1 0 .708l-2.5 2.5a.5.5 0 0 1-.708-.708l1.647-1.646H9.5a.5.5 0 0 1 0-1h3.793l-1.647-1.646a.5.5 0 0 1 0-.708",clipRule:"evenodd"})})})},585933(e,t,i){i.d(t,{H:()=>o});var a=i(105652),n=i(239976);let o=(0,a.memo)(function(e){return(0,n.jsxs)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:[(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M8 8.75A.75.75 0 0 1 8.75 8h6.5a.75.75 0 0 1 .75.75v.5a.75.75 0 0 1-.75.75h-6.5A.75.75 0 0 1 8 9.25zm0 3a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 .75.75v.5a.75.75 0 0 1-.75.75h-6.5a.75.75 0 0 1-.75-.75zM8.75 14a.75.75 0 0 0-.75.75v.5c0 .414.336.75.75.75h6.5a.75.75 0 0 0 .75-.75v-.5a.75.75 0 0 0-.75-.75z",clipRule:"evenodd"}),(0,n.jsx)("path",{fill:"var(--fpl-icon-color-3, var(--color-icon-tertiary))",fillRule:"evenodd",d:"M6.5 6h11a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5M5 6.5A1.5 1.5 0 0 1 6.5 5h11A1.5 1.5 0 0 1 19 6.5v11a1.5 1.5 0 0 1-1.5 1.5h-11A1.5 1.5 0 0 1 5 17.5z",clipRule:"evenodd"})]})})},519226(e,t,i){i.d(t,{B:()=>o});var a=i(105652),n=i(239976);let o=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24L",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M18 4a1.5 1.5 0 0 1 1.5 1.5v1a1.5 1.5 0 0 1-1.037 1.426L18.274 10H19a.5.5 0 0 1 0 1h-.816l-.653 7.18A2 2 0 0 1 15.54 20H8.461a2 2 0 0 1-1.992-1.82L5.815 11H5a.5.5 0 0 1 0-1h.725l-.189-2.074A1.5 1.5 0 0 1 4.5 6.5v-1A1.5 1.5 0 0 1 6 4zM7.465 18.09a1 1 0 0 0 .996.91h7.078a1 1 0 0 0 .996-.91L17.452 8H6.548zm6.182-7.443a.5.5 0 1 1 .707.707L12.707 13l1.646 1.646a.5.5 0 1 1-.707.707L12 13.708l-1.646 1.646a.5.5 0 1 1-.708-.707L11.293 13l-1.647-1.646a.5.5 0 1 1 .707-.707L12 12.293zM6 5a.5.5 0 0 0-.5.5v1A.5.5 0 0 0 6 7h12a.5.5 0 0 0 .5-.5v-1A.5.5 0 0 0 18 5z"})})})}}]);

//# debugId=18bfa023-56ed-51a3-9120-d05c3cfed9fb

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/b5da8199432fcf35c15e9cd0b9ee0d4813a6a0b5/2749-dd0f8b5ac5dd206b.min.js.map